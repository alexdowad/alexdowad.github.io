---
layout: post
title:  "Visualizing the Complex Sine and Cosine"
date:   2024-07-04
categories:
  - math
  - complex analysis
stylesheets:
  - katex.css
  - complexsincos.css
---

<p>Mathematically inclined readers probably know the (real) sine and cosine functions like old friends; but are you just as intimate with the <i>complex</i> sine and cosine? This article will take you on a tour of their key properties, using interactive visualizations. (If you need a refresher on how complex numbers work, you could try <a href="https://betterexplained.com/articles/a-visual-intuitive-guide-to-imaginary-numbers/">this article from BetterExplained</a> first.)</p>

<p>Before we start, what are the “complex sine and cosine” functions? One definition uses the power series for the real sine and cosine:</p>

<p id='powerseries' style='text-align: center'>
  <!-- \sin(x) = x - {x^3 \over 3!} + {x^5 \over 5!} - {x^7 \over 7!} + \ldots -->
  <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mop">sin</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 0.6667em; vertical-align: -0.0833em;"></span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span class="base"><span class="strut" style="height: 2.1771em; vertical-align: -0.686em;"></span><span class="mord"><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.4911em;"><span style="top: -2.314em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord">3</span><span class="mclose">!</span></span></span><span style="top: -3.23em;"><span class="pstrut" style="height: 3em;"></span><span class="frac-line" style="border-bottom-width: 0.04em;"></span></span><span style="top: -3.677em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.8141em;"><span style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.686em;"></span></span></span></span><span class="mclose nulldelimiter"></span></span></span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span class="base"><span class="strut" style="height: 2.1771em; vertical-align: -0.686em;"></span><span class="mord"><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.4911em;"><span style="top: -2.314em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord">5</span><span class="mclose">!</span></span></span><span style="top: -3.23em;"><span class="pstrut" style="height: 3em;"></span><span class="frac-line" style="border-bottom-width: 0.04em;"></span></span><span style="top: -3.677em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.8141em;"><span style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">5</span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.686em;"></span></span></span></span><span class="mclose nulldelimiter"></span></span></span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span class="base"><span class="strut" style="height: 2.1771em; vertical-align: -0.686em;"></span><span class="mord"><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.4911em;"><span style="top: -2.314em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord">7</span><span class="mclose">!</span></span></span><span style="top: -3.23em;"><span class="pstrut" style="height: 3em;"></span><span class="frac-line" style="border-bottom-width: 0.04em;"></span></span><span style="top: -3.677em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.8141em;"><span style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">7</span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.686em;"></span></span></span></span><span class="mclose nulldelimiter"></span></span></span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span class="base"><span class="strut" style="height: 0.123em;"></span><span class="minner">…</span></span></span></span>
</p>
<p style='text-align: center'>
  <!-- \cos(x) = 1 - {x^2 \over 2!} + {x^4 \over 4!} - {x^6 \over 6!} + \ldots -->
  <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mop">cos</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 0.7278em; vertical-align: -0.0833em;"></span><span class="mord">1</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span class="base"><span class="strut" style="height: 2.1771em; vertical-align: -0.686em;"></span><span class="mord"><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.4911em;"><span style="top: -2.314em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord">2</span><span class="mclose">!</span></span></span><span style="top: -3.23em;"><span class="pstrut" style="height: 3em;"></span><span class="frac-line" style="border-bottom-width: 0.04em;"></span></span><span style="top: -3.677em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.8141em;"><span style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.686em;"></span></span></span></span><span class="mclose nulldelimiter"></span></span></span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span class="base"><span class="strut" style="height: 2.1771em; vertical-align: -0.686em;"></span><span class="mord"><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.4911em;"><span style="top: -2.314em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord">4</span><span class="mclose">!</span></span></span><span style="top: -3.23em;"><span class="pstrut" style="height: 3em;"></span><span class="frac-line" style="border-bottom-width: 0.04em;"></span></span><span style="top: -3.677em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.8141em;"><span style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">4</span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.686em;"></span></span></span></span><span class="mclose nulldelimiter"></span></span></span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span class="base"><span class="strut" style="height: 2.1771em; vertical-align: -0.686em;"></span><span class="mord"><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.4911em;"><span style="top: -2.314em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord">6</span><span class="mclose">!</span></span></span><span style="top: -3.23em;"><span class="pstrut" style="height: 3em;"></span><span class="frac-line" style="border-bottom-width: 0.04em;"></span></span><span style="top: -3.677em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.8141em;"><span style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">6</span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.686em;"></span></span></span></span><span class="mclose nulldelimiter"></span></span></span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span class="base"><span class="strut" style="height: 0.123em;"></span><span class="minner">…</span></span></span></span>
</p>

<p>Take the same power series, and allow the value of <span class="katex"><span class="base"><span class="strut" style="height: 0.4306em;"></span><span class="mord mathnormal">x</span></span></span> to be a complex number. That’s it! Or equivalently, you could take the <a href="https://en.wikipedia.org/wiki/Euler%27s_formula#Relationship_to_trigonometry">exponential definition of the sine and cosine</a>, and likewise, allow the input parameter <span class="katex"><span class="base"><span class="strut" style="height: 0.4306em;"></span><span class="mord mathnormal">x</span></span></span> to take complex values.</p>

<p>So what do we get by letting <span class="katex"><span class="base"><span class="strut" style="height: 0.4306em;"></span><span class="mord mathnormal">x</span></span></span> be complex? Does anything interesting happen? Do these new, generalized versions of the sine and cosine behave like the “normal” versions? Or do the familiar properties of <span class="katex" style="font-size:1.1em"><span class="base"><span class="strut" style="height: 0.6679em;"></span><span class="mop">sin</span></span></span> and <span class="katex" style="font-size:1.1em"><span class="base"><span class="strut" style="height: 0.4306em;"></span><span class="mop">cos</span></span></span> totally break down? Will graphing complex <span class="katex" style="font-size:1.1em"><span class="base"><span class="strut" style="height: 0.6679em;"></span><span class="mop">sin</span></span></span> and <span class="katex" style="font-size:1.1em"><span class="base"><span class="strut" style="height: 0.4306em;"></span><span class="mop">cos</span></span></span> result in some pretty pictures?<sup><a href='#footnote1' id='fnref1'>[1]</a></sup></p>

<p>We will start by listing the most important properties of the real sine and cosine, then go through the list one by one and see what happens to each property when we move into the complex domain. Here is my list:</p>

<hr>
<p style="text-align: center; font-size: 1.12em"><span class="katex" style="font-size:1.1em"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mop">sin</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span></span></span> and <span class="katex" style="font-size:1.1em"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mop">cos</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span></span></span>...</p>

<ol>
  <li>...are periodic, with period 2π.</li>
  <li>...have bounded output values (from -1 up to 1).</li>
  <li>...satisfy the Pythagorean Identity <span class="katex" style="font-size:1.1em"><span class="base"><span class="strut" style="height: 1.1219em; vertical-align: -0.25em;"></span><span class="mop"><span class="mop">sin</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.8719em;"><span style="top: -3.1208em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span class="base"><span class="strut" style="height: 1.1141em; vertical-align: -0.25em;"></span><span class="mop"><span class="mop">cos</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.8641em;"><span style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 0.6444em;"></span><span class="mord">1</span></span></span> (for all <span class="katex"><span class="base"><span class="strut" style="height: 0.4306em;"></span><span class="mord mathnormal">x</span></span></span>)</li>
  <li>...are respectively <a href="https://en.wikipedia.org/wiki/Even_and_odd_functions">odd and even</a> (<span class="katex" style="font-size:1.1em"><span class="base"><span class="strut" style="height: 0.6679em;"></span><span class="mop">sin</span></span></span> is odd, <span class="katex" style="font-size:1.1em"><span class="base"><span class="strut" style="height: 0.4306em;"></span><span class="mop">cos</span></span></span> is even)</li>
  <li>...are identical when <span class="katex" style="font-size:1.1em"><span class="base"><span class="strut" style="height: 0.4306em;"></span><span class="mop">cos</span></span></span> is shifted forward (or <span class="katex" style="font-size:1.1em"><span class="base"><span class="strut" style="height: 0.6679em;"></span><span class="mop">sin</span></span></span> shifted back) by π/2.</li>
  <li>...are closed under differentiation (<span class="katex" style="font-size:1.1em"><span class="base"><span class="strut" style="height: 1.2251em; vertical-align: -0.345em;"></span><span class="mord"><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.8801em;"><span style="top: -2.655em;"><span class="pstrut" style="height: 3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">d</span><span class="mord mathnormal mtight">x</span></span></span></span><span style="top: -3.23em;"><span class="pstrut" style="height: 3em;"></span><span class="frac-line" style="border-bottom-width: 0.04em;"></span></span><span style="top: -3.394em;"><span class="pstrut" style="height: 3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">d</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.345em;"></span></span></span></span><span class="mclose nulldelimiter"></span></span></span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mop">sin</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mop">cos</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span></span></span>,
  <span class="katex" style="font-size:1.1em"><span class="base"><span class="strut" style="height: 1.2251em; vertical-align: -0.345em;"></span><span class="mord"><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.8801em;"><span style="top: -2.655em;"><span class="pstrut" style="height: 3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">d</span><span class="mord mathnormal mtight">x</span></span></span></span><span style="top: -3.23em;"><span class="pstrut" style="height: 3em;"></span><span class="frac-line" style="border-bottom-width: 0.04em;"></span></span><span style="top: -3.394em;"><span class="pstrut" style="height: 3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">d</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.345em;"></span></span></span></span><span class="mclose nulldelimiter"></span></span></span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mop">cos</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord">−</span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mop">sin</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span></span></span>)</li>
</ol>

<p style="text-align: center; font-size: 1.12em">So what about <span class="katex" style="font-size:1.1em"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mop">sin</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right: 0.044em;">z</span><span class="mclose">)</span></span></span> and <span class="katex" style="font-size:1.1em"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mop">cos</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right: 0.044em;">z</span><span class="mclose">)</span></span></span>?</p>
<hr>

<h2>1. Are they periodic, with period 2π?</h2>

<p>Here are 3D plots of the real and imaginary parts of the complex sine. Rotate the view and look at them from different angles.</p>

<div style='margin-block-start: 1em; margin-block-end: 1em'>
  <div style='display: flex; flex-direction: row; flex-wrap: wrap; gap: .2em'>
    <div id='sine_periodic_re' style='width: 25em; height: 25em; cursor: move; position: relative'>
      <canvas style='width: 25em; height: 25em'></canvas>
    </div>
    <div id='sine_periodic_im' style='width: 25em; height: 25em; cursor: move; position: relative'>
      <canvas style='width: 25em; height: 25em'></canvas>
    </div>
  </div>
  <small>
    <i>Drag to rotate, roll mouse wheel (or pinch) to zoom, Ctrl+drag to pan.</i>
  </small>
</div>

<script src='/assets/js/complex.js'></script>

<script>
  viridisRed = [0.26,0.26,0.26,0.26,0.27,0.27,0.27,0.27,0.27,0.27,0.27,0.27,0.27,0.28,0.28,0.28,0.28,0.28,0.28,0.28,0.28,0.28,0.28,0.28,0.28,0.28,0.28,0.28,0.28,0.28,0.27,0.27,0.27,0.27,0.27,0.27,0.27,0.27,0.27,0.26,0.26,0.26,0.26,0.26,0.26,0.26,0.26,0.25,0.25,0.25,0.25,0.25,0.25,0.25,0.24,0.24,0.24,0.24,0.24,0.23,0.23,0.23,0.23,0.23,0.23,0.22,0.22,0.22,0.22,0.21,0.21,0.21,0.21,0.21,0.21,0.2,0.2,0.2,0.2,0.19,0.19,0.19,0.19,0.19,0.19,0.19,0.18,0.18,0.18,0.18,0.17,0.17,0.17,0.17,0.17,0.17,0.17,0.17,0.16,0.16,0.16,0.16,0.16,0.16,0.16,0.16,0.15,0.15,0.15,0.15,0.15,0.14,0.14,0.14,0.14,0.14,0.14,0.14,0.14,0.13,0.13,0.13,0.13,0.13,0.13,0.12,0.12,0.12,0.12,0.12,0.12,0.12,0.12,0.12,0.12,0.12,0.12,0.12,0.12,0.11,0.11,0.11,0.12,0.12,0.12,0.12,0.12,0.12,0.12,0.12,0.12,0.12,0.13,0.13,0.13,0.14,0.14,0.14,0.14,0.15,0.15,0.16,0.16,0.17,0.17,0.17,0.18,0.19,0.19,0.2,0.2,0.21,0.21,0.22,0.23,0.23,0.24,0.25,0.25,0.26,0.27,0.28,0.28,0.29,0.3,0.31,0.32,0.32,0.33,0.34,0.35,0.35,0.36,0.37,0.38,0.39,0.4,0.41,0.42,0.42,0.43,0.44,0.45,0.46,0.47,0.48,0.49,0.5,0.51,0.52,0.53,0.54,0.55,0.56,0.57,0.58,0.59,0.6,0.61,0.62,0.63,0.64,0.65,0.66,0.67,0.68,0.69,0.7,0.71,0.72,0.73,0.75,0.75,0.76,0.78,0.78,0.8,0.81,0.82,0.83,0.84,0.85,0.86,0.87,0.88,0.89,0.9,0.91,0.92,0.93,0.94,0.95,0.96,0.96,0.98,0.98];
  viridisGreen = [0,0,0.01,0.01,0.02,0.03,0.03,0.04,0.05,0.05,0.06,0.06,0.07,0.07,0.08,0.08,0.09,0.1,0.1,0.1,0.11,0.12,0.12,0.12,0.13,0.14,0.14,0.14,0.15,0.16,0.16,0.17,0.17,0.17,0.18,0.18,0.19,0.19,0.2,0.2,0.21,0.21,0.22,0.22,0.23,0.23,0.24,0.24,0.25,0.25,0.25,0.26,0.26,0.27,0.27,0.28,0.28,0.28,0.29,0.3,0.3,0.3,0.31,0.31,0.32,0.32,0.32,0.33,0.33,0.34,0.34,0.35,0.35,0.35,0.36,0.36,0.37,0.37,0.37,0.38,0.38,0.39,0.39,0.39,0.4,0.4,0.41,0.41,0.41,0.42,0.42,0.42,0.43,0.43,0.44,0.44,0.44,0.44,0.45,0.45,0.46,0.46,0.46,0.47,0.47,0.48,0.48,0.48,0.49,0.49,0.5,0.5,0.5,0.5,0.51,0.51,0.51,0.52,0.52,0.53,0.53,0.53,0.54,0.54,0.55,0.55,0.55,0.56,0.56,0.57,0.57,0.57,0.57,0.58,0.58,0.58,0.59,0.59,0.6,0.6,0.6,0.61,0.61,0.62,0.62,0.62,0.62,0.63,0.63,0.64,0.64,0.64,0.65,0.65,0.66,0.66,0.66,0.67,0.67,0.67,0.67,0.68,0.68,0.69,0.69,0.69,0.7,0.7,0.71,0.71,0.71,0.71,0.72,0.72,0.73,0.73,0.73,0.73,0.74,0.74,0.75,0.75,0.75,0.75,0.76,0.76,0.76,0.76,0.77,0.77,0.78,0.78,0.78,0.78,0.79,0.79,0.79,0.8,0.8,0.8,0.8,0.81,0.81,0.81,0.81,0.82,0.82,0.82,0.82,0.83,0.83,0.83,0.83,0.83,0.83,0.84,0.84,0.84,0.84,0.85,0.85,0.85,0.85,0.85,0.85,0.86,0.86,0.86,0.86,0.86,0.87,0.87,0.87,0.87,0.87,0.87,0.87,0.87,0.88,0.88,0.88,0.88,0.88,0.88,0.89,0.89,0.89,0.89,0.89,0.89,0.89,0.89,0.89,0.89,0.9,0.9];
  viridisBlue = [0.32,0.33,0.33,0.34,0.35,0.35,0.36,0.36,0.37,0.37,0.38,0.39,0.39,0.4,0.4,0.41,0.41,0.42,0.42,0.42,0.43,0.43,0.44,0.44,0.45,0.45,0.46,0.46,0.46,0.47,0.47,0.47,0.48,0.48,0.48,0.49,0.49,0.49,0.5,0.5,0.5,0.5,0.51,0.51,0.51,0.51,0.51,0.51,0.52,0.52,0.52,0.52,0.53,0.53,0.53,0.53,0.53,0.53,0.53,0.53,0.53,0.53,0.54,0.54,0.54,0.54,0.54,0.54,0.54,0.54,0.54,0.54,0.55,0.55,0.55,0.55,0.55,0.55,0.55,0.55,0.55,0.55,0.55,0.55,0.55,0.55,0.55,0.55,0.55,0.55,0.55,0.55,0.55,0.55,0.55,0.55,0.55,0.55,0.55,0.55,0.55,0.55,0.55,0.55,0.55,0.55,0.55,0.55,0.55,0.55,0.55,0.55,0.55,0.55,0.55,0.55,0.55,0.55,0.55,0.55,0.55,0.55,0.55,0.55,0.55,0.55,0.55,0.55,0.54,0.54,0.54,0.54,0.54,0.54,0.54,0.54,0.54,0.53,0.53,0.53,0.53,0.53,0.53,0.53,0.53,0.53,0.52,0.52,0.52,0.52,0.51,0.51,0.51,0.51,0.51,0.51,0.5,0.5,0.5,0.5,0.5,0.49,0.49,0.49,0.48,0.48,0.48,0.48,0.47,0.47,0.47,0.46,0.46,0.46,0.45,0.45,0.44,0.44,0.44,0.43,0.43,0.42,0.42,0.42,0.41,0.41,0.41,0.4,0.4,0.39,0.39,0.38,0.38,0.37,0.37,0.36,0.35,0.35,0.35,0.34,0.33,0.33,0.32,0.32,0.31,0.31,0.3,0.3,0.29,0.28,0.28,0.27,0.26,0.26,0.25,0.25,0.24,0.23,0.23,0.22,0.21,0.21,0.2,0.19,0.18,0.18,0.17,0.16,0.16,0.15,0.14,0.14,0.13,0.12,0.12,0.12,0.11,0.1,0.1,0.1,0.09,0.09,0.09,0.09,0.09,0.09,0.09,0.1,0.1,0.1,0.11,0.11,0.12,0.12,0.13,0.14];
  viridis = { red: viridisRed, green: viridisGreen, blue: viridisBlue };

  magmaRed = [0,0,0,0,0,0,0,0.01,0.01,0.01,0.01,0.02,0.02,0.02,0.03,0.03,0.03,0.04,0.04,0.05,0.05,0.06,0.06,0.07,0.07,0.07,0.08,0.08,0.09,0.09,0.1,0.1,0.11,0.11,0.12,0.12,0.13,0.14,0.14,0.15,0.16,0.16,0.17,0.17,0.18,0.19,0.19,0.2,0.21,0.21,0.22,0.23,0.23,0.24,0.25,0.25,0.26,0.26,0.27,0.28,0.28,0.29,0.3,0.3,0.31,0.32,0.32,0.33,0.33,0.34,0.35,0.35,0.36,0.37,0.37,0.38,0.39,0.39,0.4,0.4,0.41,0.41,0.42,0.42,0.43,0.44,0.44,0.45,0.46,0.46,0.47,0.48,0.48,0.49,0.5,0.5,0.51,0.51,0.52,0.53,0.53,0.54,0.54,0.55,0.56,0.56,0.57,0.57,0.58,0.59,0.59,0.6,0.6,0.61,0.62,0.62,0.63,0.64,0.64,0.65,0.66,0.66,0.67,0.67,0.68,0.69,0.69,0.7,0.71,0.71,0.72,0.73,0.73,0.74,0.75,0.75,0.76,0.76,0.77,0.78,0.78,0.79,0.8,0.8,0.81,0.82,0.82,0.83,0.83,0.84,0.84,0.85,0.85,0.86,0.87,0.87,0.88,0.88,0.89,0.89,0.9,0.9,0.91,0.91,0.91,0.92,0.92,0.92,0.93,0.93,0.94,0.94,0.94,0.94,0.95,0.95,0.95,0.96,0.96,0.96,0.96,0.96,0.96,0.97,0.97,0.97,0.97,0.97,0.97,0.98,0.98,0.98,0.98,0.98,0.98,0.98,0.98,0.98,0.98,0.98,0.98,0.98,0.98,0.99,0.99,0.99,0.99,0.99,0.99,0.99,0.99,0.99,0.99,0.99,0.99,0.99,0.99,0.99,0.99,0.99,0.99,0.99,0.99,0.99,0.99,0.99,0.99,0.99,0.99,0.99,0.99,0.99,0.99,0.99,0.99,0.99,0.98,0.98,0.98,0.98,0.98,0.98,0.98,0.98,0.98,0.98,0.98,0.98,0.98,0.98,0.98,0.98,0.98,0.98,0.98,0.98];
  magmaGreen = [0,0,0,0,0,0,0,0.01,0.01,0.01,0.01,0.01,0.01,0.02,0.02,0.02,0.03,0.03,0.03,0.03,0.04,0.04,0.04,0.05,0.05,0.05,0.05,0.05,0.05,0.06,0.06,0.06,0.06,0.06,0.06,0.06,0.06,0.07,0.07,0.07,0.06,0.06,0.06,0.06,0.06,0.06,0.06,0.06,0.06,0.06,0.05,0.05,0.05,0.05,0.05,0.05,0.05,0.06,0.06,0.06,0.06,0.06,0.06,0.07,0.07,0.07,0.07,0.07,0.08,0.08,0.08,0.08,0.08,0.09,0.09,0.09,0.1,0.1,0.1,0.1,0.1,0.11,0.11,0.11,0.12,0.12,0.12,0.12,0.12,0.13,0.13,0.13,0.13,0.14,0.14,0.14,0.14,0.14,0.15,0.15,0.15,0.16,0.16,0.16,0.16,0.16,0.16,0.17,0.17,0.17,0.17,0.17,0.17,0.18,0.18,0.18,0.18,0.19,0.19,0.19,0.19,0.19,0.2,0.2,0.2,0.2,0.21,0.21,0.21,0.21,0.21,0.22,0.22,0.22,0.22,0.23,0.23,0.23,0.23,0.24,0.24,0.24,0.25,0.25,0.25,0.25,0.26,0.26,0.26,0.26,0.27,0.27,0.28,0.28,0.28,0.29,0.3,0.3,0.3,0.31,0.32,0.32,0.32,0.33,0.33,0.34,0.35,0.35,0.36,0.37,0.37,0.38,0.39,0.39,0.4,0.41,0.41,0.42,0.42,0.43,0.44,0.45,0.46,0.46,0.47,0.48,0.48,0.49,0.5,0.51,0.51,0.52,0.53,0.53,0.54,0.55,0.56,0.57,0.57,0.58,0.59,0.6,0.6,0.61,0.62,0.62,0.63,0.64,0.65,0.66,0.66,0.67,0.67,0.68,0.69,0.7,0.71,0.71,0.72,0.73,0.73,0.74,0.75,0.75,0.76,0.77,0.78,0.78,0.79,0.8,0.8,0.81,0.82,0.83,0.83,0.84,0.85,0.85,0.86,0.87,0.88,0.88,0.89,0.9,0.91,0.91,0.92,0.92,0.93,0.94,0.95,0.96,0.96,0.97,0.98,0.98];
  magmaBlue = [0.01,0.01,0.02,0.03,0.03,0.04,0.05,0.05,0.07,0.07,0.08,0.09,0.1,0.1,0.11,0.12,0.13,0.14,0.14,0.16,0.16,0.17,0.18,0.19,0.2,0.21,0.21,0.23,0.23,0.24,0.25,0.26,0.27,0.28,0.29,0.3,0.31,0.32,0.33,0.34,0.35,0.35,0.37,0.37,0.38,0.39,0.4,0.41,0.41,0.42,0.42,0.43,0.44,0.44,0.45,0.45,0.46,0.46,0.46,0.46,0.47,0.47,0.48,0.48,0.48,0.48,0.48,0.48,0.49,0.49,0.49,0.49,0.49,0.49,0.5,0.5,0.5,0.5,0.5,0.5,0.5,0.5,0.5,0.5,0.5,0.5,0.5,0.5,0.5,0.5,0.5,0.5,0.5,0.5,0.5,0.5,0.5,0.5,0.5,0.5,0.5,0.5,0.5,0.5,0.5,0.5,0.5,0.5,0.5,0.5,0.5,0.49,0.49,0.49,0.49,0.49,0.49,0.49,0.48,0.48,0.48,0.48,0.48,0.48,0.48,0.48,0.47,0.47,0.47,0.47,0.46,0.46,0.46,0.46,0.46,0.45,0.45,0.45,0.44,0.44,0.44,0.44,0.44,0.43,0.43,0.43,0.42,0.42,0.42,0.42,0.41,0.41,0.41,0.4,0.4,0.4,0.39,0.39,0.39,0.39,0.38,0.38,0.38,0.37,0.37,0.37,0.37,0.36,0.36,0.36,0.36,0.36,0.35,0.35,0.35,0.35,0.35,0.35,0.35,0.35,0.35,0.35,0.35,0.36,0.36,0.36,0.36,0.36,0.37,0.37,0.37,0.37,0.37,0.38,0.38,0.39,0.39,0.39,0.4,0.4,0.41,0.41,0.41,0.42,0.42,0.42,0.43,0.44,0.44,0.44,0.45,0.46,0.46,0.46,0.47,0.48,0.48,0.49,0.49,0.5,0.5,0.51,0.51,0.52,0.53,0.53,0.54,0.55,0.55,0.56,0.57,0.57,0.58,0.58,0.59,0.6,0.6,0.61,0.62,0.62,0.63,0.64,0.65,0.66,0.66,0.67,0.67,0.68,0.69,0.7,0.71,0.71,0.72,0.73,0.73,0.74];
  magma = { red: magmaRed, green: magmaGreen, blue: magmaBlue };

  coolRed = [0.43,0.42,0.42,0.42,0.42,0.42,0.41,0.41,0.41,0.41,0.41,0.41,0.4,0.4,0.4,0.4,0.4,0.4,0.39,0.39,0.39,0.38,0.38,0.38,0.38,0.38,0.37,0.37,0.37,0.36,0.36,0.36,0.36,0.35,0.35,0.34,0.34,0.34,0.34,0.33,0.33,0.33,0.32,0.32,0.32,0.31,0.31,0.31,0.3,0.3,0.3,0.29,0.29,0.29,0.29,0.28,0.28,0.27,0.27,0.27,0.26,0.26,0.26,0.25,0.25,0.25,0.24,0.24,0.23,0.23,0.23,0.23,0.22,0.22,0.21,0.21,0.21,0.21,0.2,0.2,0.2,0.19,0.19,0.19,0.18,0.18,0.18,0.18,0.17,0.17,0.16,0.16,0.16,0.16,0.16,0.15,0.15,0.14,0.14,0.14,0.14,0.14,0.13,0.13,0.13,0.13,0.12,0.12,0.12,0.12,0.12,0.12,0.11,0.11,0.11,0.11,0.11,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.09,0.09,0.09,0.09,0.09,0.09,0.09,0.09,0.09,0.09,0.09,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.11,0.11,0.11,0.11,0.12,0.12,0.12,0.12,0.12,0.13,0.13,0.13,0.14,0.14,0.14,0.14,0.15,0.15,0.15,0.16,0.16,0.16,0.17,0.17,0.18,0.18,0.18,0.19,0.19,0.2,0.2,0.2,0.21,0.21,0.22,0.22,0.23,0.23,0.24,0.24,0.25,0.25,0.26,0.27,0.27,0.28,0.28,0.29,0.29,0.3,0.3,0.31,0.32,0.32,0.33,0.34,0.34,0.35,0.36,0.36,0.37,0.38,0.38,0.39,0.4,0.4,0.41,0.41,0.42,0.43,0.44,0.45,0.45,0.46,0.47,0.47,0.48,0.49,0.5,0.5,0.51,0.52,0.52,0.53,0.54,0.55,0.56,0.56,0.57,0.58,0.58,0.59,0.6,0.61,0.61,0.62,0.63,0.64,0.65,0.65,0.66,0.67,0.67,0.68];
  coolGreen = [0.25,0.25,0.25,0.25,0.26,0.26,0.26,0.27,0.27,0.27,0.27,0.28,0.28,0.29,0.29,0.29,0.29,0.3,0.3,0.3,0.31,0.31,0.31,0.32,0.32,0.32,0.33,0.33,0.34,0.34,0.34,0.35,0.35,0.36,0.36,0.36,0.37,0.37,0.38,0.38,0.38,0.39,0.39,0.4,0.4,0.4,0.41,0.41,0.41,0.42,0.42,0.43,0.43,0.44,0.44,0.45,0.45,0.45,0.46,0.46,0.47,0.47,0.48,0.48,0.49,0.49,0.5,0.5,0.5,0.51,0.51,0.52,0.52,0.53,0.53,0.54,0.54,0.55,0.55,0.56,0.56,0.57,0.57,0.58,0.58,0.58,0.59,0.6,0.6,0.6,0.61,0.61,0.62,0.62,0.63,0.63,0.64,0.64,0.65,0.65,0.65,0.66,0.67,0.67,0.67,0.68,0.68,0.69,0.69,0.7,0.7,0.7,0.71,0.72,0.72,0.72,0.73,0.73,0.74,0.74,0.74,0.75,0.76,0.76,0.76,0.77,0.77,0.78,0.78,0.78,0.79,0.79,0.8,0.8,0.8,0.81,0.81,0.81,0.82,0.82,0.83,0.83,0.83,0.83,0.84,0.84,0.85,0.85,0.85,0.85,0.86,0.86,0.87,0.87,0.87,0.87,0.88,0.88,0.88,0.89,0.89,0.89,0.89,0.9,0.9,0.9,0.9,0.9,0.91,0.91,0.91,0.92,0.92,0.92,0.92,0.92,0.92,0.93,0.93,0.93,0.93,0.94,0.94,0.94,0.94,0.94,0.94,0.94,0.94,0.95,0.95,0.95,0.95,0.95,0.95,0.95,0.95,0.96,0.96,0.96,0.96,0.96,0.96,0.96,0.96,0.96,0.96,0.96,0.96,0.96,0.96,0.96,0.96,0.96,0.96,0.96,0.96,0.96,0.96,0.96,0.96,0.96,0.96,0.96,0.96,0.96,0.96,0.96,0.96,0.96,0.96,0.96,0.96,0.96,0.96,0.96,0.95,0.95,0.95,0.95,0.95,0.95,0.95,0.95,0.95,0.94,0.94,0.94,0.94,0.94,0.94,0.94,0.94,0.94,0.94,0.94];
  coolBlue = [0.66,0.67,0.67,0.68,0.68,0.69,0.69,0.7,0.7,0.7,0.71,0.72,0.72,0.72,0.73,0.74,0.74,0.74,0.75,0.75,0.76,0.76,0.76,0.77,0.77,0.78,0.78,0.78,0.79,0.79,0.8,0.8,0.8,0.81,0.81,0.81,0.81,0.82,0.82,0.83,0.83,0.83,0.83,0.84,0.84,0.84,0.85,0.85,0.85,0.85,0.85,0.85,0.86,0.86,0.86,0.86,0.87,0.87,0.87,0.87,0.87,0.87,0.87,0.87,0.87,0.87,0.88,0.88,0.88,0.88,0.88,0.88,0.88,0.88,0.88,0.88,0.88,0.88,0.88,0.88,0.88,0.88,0.88,0.87,0.87,0.87,0.87,0.87,0.87,0.87,0.87,0.87,0.86,0.86,0.86,0.86,0.86,0.85,0.85,0.85,0.85,0.85,0.84,0.84,0.84,0.83,0.83,0.83,0.83,0.82,0.82,0.82,0.81,0.81,0.81,0.8,0.8,0.8,0.8,0.79,0.79,0.78,0.78,0.78,0.77,0.77,0.76,0.76,0.75,0.75,0.74,0.74,0.74,0.73,0.73,0.72,0.72,0.71,0.71,0.7,0.7,0.69,0.69,0.69,0.68,0.67,0.67,0.67,0.66,0.65,0.65,0.65,0.64,0.63,0.63,0.62,0.62,0.61,0.61,0.6,0.6,0.6,0.59,0.58,0.58,0.57,0.57,0.56,0.56,0.55,0.55,0.54,0.54,0.53,0.53,0.52,0.52,0.51,0.51,0.5,0.5,0.49,0.49,0.49,0.48,0.47,0.47,0.47,0.46,0.46,0.45,0.45,0.45,0.44,0.43,0.43,0.43,0.42,0.42,0.41,0.41,0.41,0.41,0.4,0.4,0.4,0.39,0.39,0.39,0.38,0.38,0.38,0.38,0.37,0.37,0.37,0.36,0.36,0.36,0.36,0.36,0.35,0.35,0.35,0.35,0.34,0.34,0.34,0.34,0.34,0.34,0.34,0.34,0.34,0.34,0.34,0.34,0.34,0.34,0.34,0.34,0.34,0.34,0.34,0.34,0.34,0.34,0.34,0.34,0.34,0.34,0.34,0.34,0.35,0.35,0.35];
  cool = { red: coolRed, green: coolGreen, blue: coolBlue };

  warmRed = [0.43,0.43,0.44,0.44,0.45,0.45,0.46,0.47,0.47,0.48,0.49,0.49,0.5,0.5,0.51,0.52,0.52,0.53,0.54,0.54,0.55,0.56,0.56,0.57,0.58,0.58,0.59,0.59,0.6,0.61,0.61,0.62,0.63,0.63,0.64,0.65,0.65,0.66,0.66,0.67,0.68,0.68,0.69,0.69,0.7,0.71,0.71,0.72,0.72,0.73,0.74,0.74,0.75,0.76,0.76,0.77,0.78,0.78,0.79,0.79,0.8,0.8,0.81,0.81,0.82,0.83,0.83,0.84,0.84,0.85,0.85,0.86,0.87,0.87,0.87,0.88,0.89,0.89,0.89,0.9,0.9,0.91,0.91,0.92,0.92,0.93,0.93,0.94,0.94,0.94,0.95,0.95,0.96,0.96,0.96,0.97,0.97,0.98,0.98,0.98,0.99,0.99,0.99,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0.99,0.99,0.99,0.98,0.98,0.98,0.97,0.97,0.97,0.96,0.96,0.96,0.95,0.95,0.94,0.94,0.94,0.93,0.93,0.92,0.92,0.92,0.91,0.91,0.9,0.9,0.9,0.89,0.89,0.89,0.88,0.88,0.87,0.87,0.87,0.86,0.85,0.85,0.85,0.84,0.84,0.83,0.83,0.83,0.82,0.82,0.81,0.81,0.8,0.8,0.8,0.79,0.79,0.78,0.78,0.78,0.77,0.77,0.76,0.76,0.76,0.75,0.75,0.74,0.74,0.74,0.73,0.73,0.72,0.72,0.72,0.71,0.71,0.71,0.7,0.7,0.7,0.69,0.69,0.69,0.69,0.68];
  warmGreen = [0.25,0.25,0.25,0.24,0.24,0.24,0.24,0.24,0.24,0.24,0.24,0.24,0.24,0.24,0.24,0.24,0.24,0.24,0.24,0.24,0.24,0.23,0.23,0.23,0.23,0.23,0.23,0.23,0.23,0.23,0.23,0.23,0.23,0.23,0.23,0.23,0.23,0.23,0.23,0.23,0.23,0.23,0.23,0.23,0.23,0.23,0.23,0.23,0.23,0.23,0.23,0.23,0.23,0.23,0.23,0.23,0.23,0.23,0.23,0.23,0.23,0.23,0.24,0.24,0.24,0.24,0.24,0.24,0.24,0.24,0.24,0.24,0.24,0.25,0.25,0.25,0.25,0.25,0.25,0.25,0.25,0.25,0.25,0.26,0.26,0.26,0.26,0.26,0.27,0.27,0.27,0.27,0.27,0.27,0.27,0.28,0.28,0.28,0.28,0.29,0.29,0.29,0.29,0.29,0.3,0.3,0.3,0.3,0.3,0.31,0.31,0.31,0.32,0.32,0.32,0.32,0.33,0.33,0.33,0.34,0.34,0.34,0.34,0.35,0.35,0.36,0.36,0.36,0.36,0.37,0.37,0.38,0.38,0.38,0.39,0.39,0.4,0.4,0.4,0.41,0.41,0.41,0.42,0.42,0.43,0.43,0.43,0.44,0.44,0.45,0.45,0.45,0.46,0.47,0.47,0.47,0.48,0.48,0.49,0.49,0.5,0.5,0.5,0.51,0.51,0.52,0.52,0.53,0.53,0.54,0.54,0.55,0.55,0.56,0.56,0.57,0.57,0.58,0.58,0.59,0.59,0.6,0.6,0.61,0.61,0.62,0.62,0.63,0.63,0.64,0.64,0.65,0.65,0.66,0.66,0.67,0.67,0.68,0.69,0.69,0.69,0.7,0.7,0.71,0.71,0.72,0.72,0.73,0.73,0.74,0.74,0.75,0.75,0.76,0.76,0.77,0.77,0.78,0.78,0.79,0.79,0.8,0.8,0.81,0.81,0.81,0.82,0.82,0.83,0.83,0.84,0.84,0.85,0.85,0.85,0.86,0.86,0.87,0.87,0.88,0.88,0.89,0.89,0.89,0.9,0.9,0.9,0.91,0.91,0.91,0.92,0.92,0.92,0.93,0.93,0.94];
  warmBlue = [0.66,0.66,0.67,0.67,0.67,0.67,0.67,0.68,0.68,0.68,0.68,0.68,0.69,0.69,0.69,0.69,0.69,0.69,0.69,0.69,0.69,0.69,0.69,0.7,0.7,0.7,0.7,0.7,0.7,0.7,0.7,0.7,0.7,0.7,0.7,0.7,0.7,0.7,0.69,0.69,0.69,0.69,0.69,0.69,0.69,0.69,0.69,0.69,0.69,0.68,0.68,0.68,0.68,0.68,0.67,0.67,0.67,0.67,0.67,0.66,0.66,0.66,0.66,0.65,0.65,0.65,0.65,0.64,0.64,0.64,0.63,0.63,0.63,0.62,0.62,0.62,0.61,0.61,0.61,0.6,0.6,0.6,0.59,0.59,0.58,0.58,0.58,0.57,0.57,0.56,0.56,0.56,0.55,0.55,0.54,0.54,0.54,0.53,0.52,0.52,0.52,0.51,0.51,0.5,0.5,0.49,0.49,0.49,0.48,0.47,0.47,0.47,0.46,0.45,0.45,0.45,0.44,0.43,0.43,0.43,0.42,0.41,0.41,0.41,0.4,0.4,0.39,0.39,0.38,0.38,0.37,0.37,0.36,0.36,0.35,0.35,0.34,0.34,0.34,0.33,0.32,0.32,0.32,0.31,0.31,0.3,0.3,0.3,0.29,0.29,0.29,0.28,0.28,0.27,0.27,0.27,0.26,0.26,0.25,0.25,0.25,0.24,0.24,0.23,0.23,0.23,0.23,0.22,0.22,0.22,0.21,0.21,0.21,0.21,0.21,0.2,0.2,0.2,0.2,0.2,0.19,0.19,0.19,0.19,0.19,0.18,0.18,0.18,0.18,0.18,0.18,0.18,0.18,0.18,0.18,0.18,0.18,0.18,0.18,0.18,0.18,0.18,0.18,0.18,0.18,0.18,0.18,0.18,0.18,0.18,0.18,0.18,0.19,0.19,0.19,0.19,0.2,0.2,0.2,0.2,0.2,0.21,0.21,0.21,0.21,0.21,0.22,0.22,0.23,0.23,0.23,0.23,0.24,0.24,0.25,0.25,0.25,0.26,0.26,0.27,0.27,0.28,0.28,0.29,0.29,0.3,0.3,0.3,0.31,0.32,0.32,0.33,0.33,0.34,0.34,0.35];
  warm = { red: warmRed, green: warmGreen, blue: warmBlue };

  function valueToColorIndex(v, min, max) {
    v = Math.min(v, max);
    v = Math.max(v, min);
    return Math.round((v - min) / (max - min) * 255);
  }

  function meshVerticesForFunction(resolution, fn, colors, min=-22, max=22, xRange=3*Math.PI, yRange=2.5*Math.PI, xOffset=0, yOffset=0) {
    const vertices = new Float32Array((resolution + 1) * (resolution + 1) * 3);
    const vertexColors = new Float32Array((resolution + 1) * (resolution + 1) * 4); // R, G, B, alpha for each

    function gridPosToComplex(x, y) {
      x -= resolution / 2;
      y -= resolution / 2;
      return new Complex([(x * xRange / resolution) + xOffset, (y * yRange / resolution) + yOffset]);
    }

    let i = 0, j = 0;

    for (let x = 0; x <= resolution; x++) {
      for (let y = 0; y <= resolution; y++) {
        let z = gridPosToComplex(x, y);
        let w = fn(z);
        vertices[i++] = z.re;
        vertices[i++] = w / 2;
        vertices[i++] = z.im;
        let ci = valueToColorIndex(w, min, max);
        vertexColors[j++] = colors.red[ci];
        vertexColors[j++] = colors.green[ci];
        vertexColors[j++] = colors.blue[ci];
        vertexColors[j++] = 0.8;
      }
    }

    return [vertices, vertexColors];
  }

  function vertexIndicesForMesh(resolution) {
    const indices = [];

    for (let x = 0; x < resolution; x++) {
      for (let y = 0; y < resolution; y++) {
        const topLeft = (x * (resolution + 1)) + y;
        const bottomLeft = topLeft + 1;
        const topRight = topLeft + (resolution + 1);
        const bottomRight = topRight + 1;
        /* Vertices for each triangle should be in counter-clockwise order */
        indices.push(bottomLeft);
        indices.push(topRight);
        indices.push(topLeft);
        indices.push(bottomLeft);
        indices.push(bottomRight);
        indices.push(topRight);
      }
    }

    return indices;
  }

  window.$id = document.getElementById.bind(document);
  Element.prototype.listen = Element.prototype.addEventListener;
  Element.prototype.$class = Element.prototype.getElementsByClassName;
  Element.prototype.$class1 = function(cls) {
    return this.getElementsByClassName(cls)[0];
  }
  Element.prototype.$tag1 = function(name) {
    return this.getElementsByTagName(name)[0];
  }
  document.$tag1 = function(name) {
    return this.getElementsByTagName(name)[0];
  }

  if (!window.WebGLRenderingContext) {
    window.hasWebGL = false;
  } else {
    const canvas = document.createElement('canvas');
    window.hasWebGL = canvas.getContext('webgl') ? true : false;
  }
</script>

<script type='importmap'>
  {
    "imports": {
      "three": "/assets/js/three.module.js"
    }
  }
</script>

<div id='hiddencanvas' style='display:none'></div>

<script type='module'>
  import * as THREE from 'three';
  import { OrbitControls } from '/assets/js/OrbitControls.js';

  if (window.hasWebGL) {

  const renderer = new THREE.WebGLRenderer({ antialias: true });
  renderer.setPixelRatio(window.devicePixelRatio);
  $id('hiddencanvas').appendChild(renderer.domElement);
  const size = new THREE.Vector2(0, 0);

  window.useSharedRenderer = function(canvas, width, height, scene, camera) {
    // `width` and `height` are CSS 'pixels', not physical display pixels
    // (`window.devicePixelRatio` gives the conversion factor)
    renderer.getSize(size);
    if (width != size.width || height != size.height) {
      renderer.setSize(width, height);
    }
    const ratio = window.devicePixelRatio;
    if (width*ratio != canvas.width || height*ratio != canvas.height) {
      // `canvas.width` and `canvas.height` are in physical pixels
      canvas.width = width*ratio;
      canvas.height = height*ratio;
    }
    renderer.render(scene, camera);
    const context = canvas.getContext('2d');
    context.drawImage(renderer.domElement, 0, 0);
  }

  const viewport1 = $id('sine_periodic_re');
  const viewport2 = $id('sine_periodic_im');

  const resolution = 30;

  const [vertices1, colors1] = meshVerticesForFunction(resolution, (z) => z.sin().re, viridis);
  const [vertices2, colors2] = meshVerticesForFunction(resolution, (z) => z.sin().im, magma);
  const indices = vertexIndicesForMesh(resolution);

  function createLine(from, to) {
    const material = new THREE.LineBasicMaterial({ color: 0xffffff });
    const geometry = new THREE.BufferGeometry().setFromPoints([from, to]);
    return new THREE.Line(geometry, material);
  }

  function projectVector(vec, camera) {
    let pos = vec.clone();
    camera.updateMatrixWorld();
    pos.project(camera);
    return pos;
  }

  function initLabel(parent, label) {
    const elem = label.elem = document.createElement('span');
    elem.textContent = label.text;
    parent.appendChild(elem);
    elem.style.position = 'absolute';
    elem.style.color = 'white';
    elem.style.userSelect = 'none';
  }

  function positionLabel(label, camera, width, height) {
    const pos = projectVector(label.vector, camera);
    const x = ((pos.x + 1) / 2) * width;
    const y = ((-pos.y + 1) / 2) * height;
    label.elem.style.left = `${x - (label.elem.clientWidth / 2)}px`;
    label.elem.style.top = `${y}px`;
  }

  function showGraph(viewport, vertices, colors) {
    let viewWidth = viewport.clientWidth, viewHeight = viewport.clientHeight;
    const canvas = viewport.$tag1('canvas');

    const scene = new THREE.Scene;
    scene.background = new THREE.Color('#121212');

    const camera = new THREE.PerspectiveCamera(45, viewWidth / viewHeight, 1, 1000);
    camera.position.set(-9.9327, 3.0861, 13.5483);
    camera.setRotationFromQuaternion(new THREE.Quaternion(-0.0966, -0.3198, -0.0328, 0.9419));

    const ambientLight = new THREE.AmbientLight(0xcccccc, 1);
    scene.add(ambientLight);

    const dirLight = new THREE.DirectionalLight(0xffffff, 3);
    dirLight.position.set(16, 18, 12);
    scene.add(dirLight);

    const geometry = new THREE.BufferGeometry;
    geometry.setIndex(indices);
    geometry.setAttribute('position', new THREE.BufferAttribute(vertices, 3));
    geometry.setAttribute('color', new THREE.BufferAttribute(colors, 4));
    geometry.computeVertexNormals();

    /* `depthWrite: false` prevents semi-transparent surfaces from occluding other
     * surfaces behind them */
    const material = new THREE.MeshPhongMaterial({
      side: THREE.DoubleSide, vertexColors: true, transparent: true, depthWrite: false
    });

    const mesh = new THREE.Mesh(geometry, material);
    scene.add(mesh);

    scene.add(createLine(new THREE.Vector3(1.5*Math.PI, 0, 0), new THREE.Vector3(-1.5*Math.PI, 0, 0)));
    scene.add(createLine(new THREE.Vector3(0, 12.5, 0), new THREE.Vector3(0, -12.5, 0)));
    scene.add(createLine(new THREE.Vector3(0, 0, 1.5*Math.PI), new THREE.Vector3(0, 0, -1.5*Math.PI)));

    const labels = [
      { text: '1', vector: new THREE.Vector3(1, 0, 0) },
      { text: '-1', vector: new THREE.Vector3(-1, 0, 0) },
      { text: 'i', vector: new THREE.Vector3(0, 0, 1) },
      { text: '-i', vector: new THREE.Vector3(0, 0, -1) },
      { text: '2', vector: new THREE.Vector3(2, 0, 0) },
      { text: '-2', vector: new THREE.Vector3(-2, 0, 0) },
      { text: '2i', vector: new THREE.Vector3(0, 0, 2) },
      { text: '-2i', vector: new THREE.Vector3(0, 0, -2) },
      { text: '3', vector: new THREE.Vector3(3, 0, 0) },
      { text: '-3', vector: new THREE.Vector3(-3, 0, 0) },
      { text: '3i', vector: new THREE.Vector3(0, 0, 3) },
      { text: '-3i', vector: new THREE.Vector3(0, 0, -3) },
    ];
    for (const label of labels)
      initLabel(viewport, label);

    let redrawNeeded = false;
    function redrawIfNeeded() {
      if (redrawNeeded)
        useSharedRenderer(canvas, viewWidth, viewHeight, scene, camera);
      redrawNeeded = false;
    }
    function redraw() {
      redrawNeeded = true;
      setTimeout(redrawIfNeeded, 80);
      for (const label of labels)
        positionLabel(label, camera, viewWidth, viewHeight);
    }

    redraw();

    const controls = new OrbitControls(camera, viewport);
    controls.addEventListener('change', redraw);

    new ResizeObserver(function() {
      viewWidth = viewport.clientWidth;
      viewHeight = viewport.clientHeight;
      redraw();
    }).observe(viewport);
  }

  showGraph(viewport1, vertices1, colors1);
  showGraph(viewport2, vertices2, colors2);

  }
</script>

<p>What do you conclude? Does it look periodic to you? (Click or tap to reveal the answer.)</p>

<div class="reveal hidden">
<p>Yes, the function is periodic (with period 2π), but only in the direction of the real axis. In the direction of the imaginary axis, the function is not periodic at all.</p>
<p>We can confirm this by looking at the exponential definition of the sine:</p>
<p style='text-align: center'><span class="katex"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mop">sin</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right: 0.044em;">z</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 2.1877em; vertical-align: -0.686em;"></span><span class="mord"><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.5017em;"><span style="top: -2.314em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord">2</span><span class="mord mathnormal">i</span></span></span><span style="top: -3.23em;"><span class="pstrut" style="height: 3em;"></span><span class="frac-line" style="border-bottom-width: 0.04em;"></span></span><span style="top: -3.677em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal">e</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.8247em;"><span style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mord mathnormal mtight" style="margin-right: 0.044em;">z</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mord"><span class="mord mathnormal">e</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.8247em;"><span style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mathnormal mtight">i</span><span class="mord mathnormal mtight" style="margin-right: 0.044em;">z</span></span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.686em;"></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></p>
<p>If the real and imaginary parts of <span class="katex" style="font-size:1.1em"><span class="base"><span class="strut" style="height: 0.4306em;"></span><span class="mord mathnormal" style="margin-right: 0.044em;">z</span></span></span> are <span class="katex" style="font-size:1.1em"><span class="base"><span class="strut" style="height: 0.4306em;"></span><span class="mord mathnormal">x</span></span></span> and <span class="katex" style="font-size:1.1em"><span class="base"><span class="strut" style="height: 0.625em; vertical-align: -0.1944em;"></span><span class="mord mathnormal" style="margin-right: 0.0359em;">y</span></span></span> (<span class="katex" style="font-size:1.1em"><span class="base"><span class="strut" style="height: 0.4306em;"></span><span class="mord mathnormal" style="margin-right: 0.044em;">z</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 0.6667em; vertical-align: -0.0833em;"></span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span class="base"><span class="strut" style="height: 0.854em; vertical-align: -0.1944em;"></span><span class="mord mathnormal">i</span><span class="mord mathnormal" style="margin-right: 0.0359em;">y</span></span></span>), that becomes:</p>
<p style='text-align: center'><span class="katex"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mop">sin</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right: 0.044em;">z</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 2.1877em; vertical-align: -0.686em;"></span><span class="mord"><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.5017em;"><span style="top: -2.314em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord">2</span><span class="mord mathnormal">i</span></span></span><span style="top: -3.23em;"><span class="pstrut" style="height: 3em;"></span><span class="frac-line" style="border-bottom-width: 0.04em;"></span></span><span style="top: -3.677em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal">e</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.7713em;"><span style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mathnormal mtight" style="margin-right: 0.0359em;">y</span></span></span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal">e</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.8247em;"><span style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mord mathnormal mtight">x</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mord"><span class="mord mathnormal">e</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.6644em;"><span style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right: 0.0359em;">y</span></span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal">e</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.8247em;"><span style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mathnormal mtight">i</span><span class="mord mathnormal mtight">x</span></span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.686em;"></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></p>
<p>Clearly, the <span class="katex" style="font-size:1.1em"><span class="base"><span class="strut" style="height: 0.8747em;"></span><span class="mord"><span class="mord mathnormal">e</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.8747em;"><span style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnorma mtight">i</span><span class="mord mathnormal mtight">x</span></span></span></span></span></span></span></span></span></span></span> and <span class="katex" style="font-size:1.1em"><span class="base"><span class="strut" style="height: 0.8747em;"></span><span class="mord"><span class="mord mathnormal">e</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.8747em;"><span style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mathnormal mtight">i</span><span class="mord mathnormal mtight">x</span></span></span></span></span></span></span></span></span></span></span> terms will come back to the same values every time <span class="katex" style="font-size:1.1em"><span class="base"><span class="strut" style="height: 0.4306em;"></span><span class="mord mathnormal">x</span></span></span> increases by 2π, but the <span class="katex" style="font-size:1.1em"><span class="base"><span class="strut" style="height: 0.7144em;"></span><span class="mord"><span class="mord mathnormal">e</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.7144em;"><span style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right: 0.0359em;">y</span></span></span></span></span></span></span></span></span></span> and <span class="katex"><span class="base"><span class="strut" style="height: 0.8213em;"></span><span class="mord"><span class="mord mathnormal">e</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.8213em;"><span style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mathnormal mtight" style="margin-right: 0.0359em;">y</span></span></span></span></span></span></span></span></span></span></span> terms will never come back to the same values as <span class="katex" style="font-size:1.1em"><span class="base"><span class="strut" style="height: 0.625em; vertical-align: -0.1944em;"></span><span class="mord mathnormal" style="margin-right: 0.0359em;">y</span></span></span> increases.</p>
</div>

<h2>2. Do their values range from -1 up to 1?</h2>

<p>This one is obvious when you look at a graph. Here is a <i>modular</i> graph of the complex sine; the height of the graph represents the magnitude (<span class="katex" style="font-size:1.1em"><span class="base"><span class="strut" style="height: 1.24em; vertical-align: -0.2561em;"></span><span class="mord sqrt"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.9839em;"><span class="svg-align" style="top: -3.2em;"><span class="pstrut" style="height: 3.2em;"></span><span class="mord" style="padding-left: 1em;"><span class="mord text"><span class="mord">Re</span></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right: 0.044em;">z</span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.7401em;"><span style="top: -2.989em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mord text"><span class="mord">Im</span></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right: 0.044em;">z</span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.7401em;"><span style="top: -2.989em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span><span style="top: -2.9439em;"><span class="pstrut" style="height: 3.2em;"></span><span class="hide-tail" style="min-width: 1.02em; height: 1.28em;"><svg width="400em" height="1.28em" viewBox="0 0 400000 1296" preserveAspectRatio="xMinYMin slice"><path d="M263,681c0.7,0,18,39.7,52,119
c34,79.3,68.167,158.7,102.5,238c34.3,79.3,51.8,119.3,52.5,120
c340,-704.7,510.7,-1060.3,512,-1067
l0 -0
c4.7,-7.3,11,-11,19,-11
H40000v40H1012.3
s-271.3,567,-271.3,567c-38.7,80.7,-84,175,-136,283c-52,108,-89.167,185.3,-111.5,232
c-22.3,46.7,-33.8,70.3,-34.5,71c-4.7,4.7,-12.3,7,-23,7s-12,-1,-12,-1
s-109,-253,-109,-253c-72.7,-168,-109.3,-252,-110,-252c-10.7,8,-22,16.7,-34,26
c-22,17.3,-33.3,26,-34,26s-26,-26,-26,-26s76,-59,76,-59s76,-60,76,-60z
M1001 80h400000v40h-400000z"></path></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.2561em;"></span></span></span></span></span></span>, also written as <span class="katex" style="font-size:1.1em"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord">∣</span><span class="mord mathnormal" style="margin-right: 0.044em;">z</span><span class="mord">∣</span></span></span>) of the complex sine at that point. I’ve drawn a (white-colored) horizontal plane slicing the graph at <span class="katex" style="font-size:1.1em"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord">∣</span><span class="mord mathnormal" style="margin-right: 0.044em;">z</span><span class="mord">∣</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 0.6444em;"></span><span class="mord">1</span></span></span>.</p>

<div style='display: flex; flex-direction: column; gap: .2em; margin-block-start: 1em; margin-block-end: 1em'>
  <div id='sine_magnitude' style='width: 35em; height: 35em; cursor: move'>
    <canvas style='width: 35em; height: 35em'></canvas>
  </div>
  <small>
    <i>Again, drag to rotate, roll mouse wheel (or pinch) to zoom, Ctrl+drag to pan. Try peeking under the white plane at <span class="katex" style="font-size:1.1em"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord">∣</span><span class="mord mathnormal" style="margin-right: 0.044em;">z</span><span class="mord">∣</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 0.6444em;"></span><span class="mord">1</span></span></span> to see the familiar shape of the real sine function.</i>
  </small>
</div>

<script type='module'>
  import * as THREE from 'three';
  import { OrbitControls } from '/assets/js/OrbitControls.js';

  if (window.hasWebGL) {

  const viewport = $id('sine_magnitude');
  const resolution = 28;
  const [vertices, colors] = meshVerticesForFunction(resolution, (z) => z.sin().abs(), cool, 0, Math.PI * 4);
  const indices = vertexIndicesForMesh(resolution);

  function showGraph(viewport, vertices, colors) {
    let viewWidth = viewport.clientWidth, viewHeight = viewport.clientHeight;
    const canvas = viewport.$tag1('canvas');

    const scene = new THREE.Scene;
    scene.background = new THREE.Color('#121212');

    const camera = new THREE.PerspectiveCamera(45, viewWidth / viewHeight, 1, 1000);
    camera.position.set(-11.86, 22.95, 10.03);
    camera.rotation.set(-1.01, -0.56, -0.71);

    const ambientLight = new THREE.AmbientLight(0xcccccc, 1);
    scene.add(ambientLight);

    const dirLight = new THREE.DirectionalLight(0xffffff, 3);
    dirLight.position.set(16, 18, 12);
    scene.add(dirLight);

    const geometry = new THREE.BufferGeometry;
    geometry.setIndex(indices);
    geometry.setAttribute('position', new THREE.BufferAttribute(vertices, 3));
    geometry.setAttribute('color', new THREE.BufferAttribute(colors, 4));
    geometry.computeVertexNormals();

    const material = new THREE.MeshPhongMaterial({
      side: THREE.DoubleSide, vertexColors: true, transparent: true, depthWrite: false
    });

    const mesh = new THREE.Mesh(geometry, material);
    scene.add(mesh);

    const plane = new THREE.PlaneGeometry(Math.PI * 3, 7);
    plane.rotateX(-Math.PI * 0.5);
    plane.translate(0, 0.5, 0);
    scene.add(new THREE.Mesh(plane, new THREE.MeshPhongMaterial({ color: 0xcccccc, side: THREE.DoubleSide })));

    let redrawNeeded = false;
    function redrawIfNeeded() {
      if (redrawNeeded)
        useSharedRenderer(canvas, viewWidth, viewHeight, scene, camera);
      redrawNeeded = false;
    }
    function redraw() {
      redrawNeeded = true;
      setTimeout(redrawIfNeeded, 80);
    }

    redraw();

    const controls = new OrbitControls(camera, viewport);
    controls.target.set(3.3, 2.611, -2.581);
    controls.update();
    controls.addEventListener('change', redraw);

    new ResizeObserver(function() {
      viewWidth = viewport.clientWidth;
      viewHeight = viewport.clientHeight;
      redraw();
    }).observe(viewport);
  }

  showGraph(viewport, vertices, colors);

  }
</script>

<p>What do you conclude?</p>

<p class='reveal hidden'><span class="katex" style="font-size:1.1em"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mop">sin</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right: 0.044em;">z</span><span class="mclose">)</span></span></span> is only bounded when we move in the direction of the real axis. In the direction of the imaginary axis, its value is unbounded. The same is true of <span class="katex" style="font-size:1.1em"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mop">cos</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right: 0.044em;">z</span><span class="mclose">)</span></span></span>, for reasons which will become clear later in this article.</p>

<h2>3. Does the Pythagorean Identity still work?</h2>

<p>For real numbers, the Pythagorean Identity <span class="katex" style="font-size:1.1em"><span class="base"><span class="strut" style="height: 1.1219em; vertical-align: -0.25em;"></span><span class="mop"><span class="mop">sin</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.8719em;"><span style="top: -3.1208em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span class="base"><span class="strut" style="height: 1.1141em; vertical-align: -0.25em;"></span><span class="mop"><span class="mop">cos</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.8641em;"><span style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 0.6444em;"></span><span class="mord">1</span></span></span> tells us that the sine and cosine of an angle can be thought of as the side lengths of a right triangle with unit hypotenuse. Like this:</p>

<div style='margin-block-start: 1em; margin-block-end: 1em'>
  <div>
    <svg id='real_sin_cos_circle' style='width: 20em; height: 20em; user-select: none' viewbox='0 0 100 100'>
      <defs>
        <marker id='arrow1' viewbox='0 0 8 8' refX='6.5' refY='4' markerWidth='5' markerHeight='5' orient='0' stroke='context-stroke' fill='context-fill'>
          <path d='M 0 0 L 8 4 L 0 8 z' />
        </marker>
      </defs>
    </svg>
    <svg id='real_sin_cos_wave' style='width: 20em; height: 20em; user-select: none' viewbox='0 0 100 100'>
    </svg>
  </div>
  <small><i>Drag the arrow around the circle. The length of the red line is the sine, the length of the blue line is the cosine. Note that together with the arrow, they form a right triangle.</i></small>
</div>

<script>
  'use strict';

  function makeSvgNode(tag, cssClass, attributes = {}) {
    const node = document.createElementNS("http://www.w3.org/2000/svg", tag);
    if (cssClass)
      node.classList.add(cssClass);
    for (const [key, value] of Object.entries(attributes))
      node.setAttribute(key, value);
    return node;
  }

  function appendSvgNode(parent, tag, cssClass, attributes = {}) {
    const node = makeSvgNode(tag, cssClass, attributes);
    parent.appendChild(node);
    return node;
  }

  function prependSvgNode(parent, tag, cssClass, attributes = {}) {
    const node = makeSvgNode(tag, cssClass, attributes);
    parent.prepend(node);
    return node;
  }

  /* Take mouse position in pixels (from edge of SVG), convert to SVG units */
  function mousePosToSvgPos(event, svg) {
    const CTM = svg.getScreenCTM();
    if (event.touches)
      event = event.touches[0];
    return {
      svgX: (event.clientX - CTM.e) / CTM.a,
      svgY: (event.clientY - CTM.f) / CTM.d
    };
  }

  function svgPosDistance(pos1, pos2) {
    return Math.sqrt((pos1.svgX - pos2.svgX) ** 2 + (pos1.svgY - pos2.svgY) ** 2);
  }

  const circleX = 50, circleY = 50, circleRadius = 45;

  function svgArrowheadPos(arrow) {
    return {
      svgX: ((Number(arrow.getAttribute('x2')) - circleX) * 0.9) + circleX,
      svgY: ((Number(arrow.getAttribute('y2')) - circleY) * 0.9) + circleY
    }
  }

  function svgPosToAngle(pos) {
    const offsetX = pos.svgX - circleX, offsetY = circleY - pos.svgY;
    return Math.atan2(offsetY, offsetX);
  }

  const lineOffset = 1.6; // space between line and circle, to make room for arrowhead marker

  function moveSvgArrow(arrow, marker, pos) {
    const angle = svgPosToAngle(pos);
    arrow.setAttribute('x2', Math.round((circleX + ((circleRadius - lineOffset) * Math.cos(angle))) * 10) / 10);
    arrow.setAttribute('y2', Math.round((circleY + -((circleRadius - lineOffset) * Math.sin(angle))) * 10) / 10);
    marker.setAttribute('orient', Math.round(-angle / Math.PI * 180));
  }

  function makeSvgArrowDraggable(svg, arrow, marker, callback) {
    let dragging = false;
    let startPos, arrowPos;

    function startDrag(event) {
      dragging = true;
      startPos = mousePosToSvgPos(event, svg);
      arrowPos = svgArrowheadPos(arrow);
      return false;
    }
    function touchStartDrag(event) {
      if (!dragging) {
        const touchPos = mousePosToSvgPos(event, svg);
        arrowPos = svgArrowheadPos(arrow);
        if (svgPosDistance(touchPos, arrowPos) < 5.5)
          startDrag(event);
      }
    }
    function drag(event) {
      if (dragging) {
        const dragPos = mousePosToSvgPos(event, svg);
        moveSvgArrow(arrow, marker, dragPos);
        if (callback)
          callback(dragPos);
        event.preventDefault(); // Suppress scrolling of page on mobile
        return false;
      }
    }
    function endDrag(event) {
      dragging = false;
    }
    arrow.listen('mousedown', startDrag);
    arrow.classList.add('draggable');
    svg.listen('mousemove', drag);
    svg.listen('mouseup', endDrag)
    svg.listen('mouseleave', endDrag);
    svg.listen('touchstart', touchStartDrag, { passive: false });
    svg.listen('touchmove', drag, { passive: false });
    svg.listen('touchend', endDrag);
    svg.listen('touchleave', endDrag);
    svg.listen('touchcancel', endDrag);
  }

  {
    const svg1 = $id('real_sin_cos_circle');
    const svg2 = $id('real_sin_cos_wave');

    const bigCircle = appendSvgNode(svg1, 'circle', undefined, {
      r: circleRadius,
      stroke: '#333',
      fill: 'none',
      cx: circleX,
      cy: circleY
    });
    const redLine = appendSvgNode(svg1, 'line', undefined, {
      x1: circleX + circleRadius,
      x2: circleX + circleRadius,
      y1: circleY,
      y2: circleY,
      stroke: '#c33'
    });
    const blueLine = appendSvgNode(svg1, 'line', undefined, {
      x1: circleX,
      x2: circleX + circleRadius,
      y1: circleY,
      y2: circleY,
      stroke: '#33c'
    });
    const arrow = appendSvgNode(svg1, 'line', undefined, {
      x1: circleX,
      x2: circleX + circleRadius - lineOffset,
      y1: circleY,
      y2: circleY,
      stroke: '#333',
      'stroke-width': '2.2',
      fill: '#333',
      'marker-end': 'url(#arrow1)'
    });
    const marker = $id('arrow1');

    const graphStart = 5, graphEnd = 95, graphHeight = circleRadius;
    appendSvgNode(svg2, 'line', undefined, {
      x1: graphStart,
      x2: graphEnd,
      y1: '50',
      y2: '50',
      stroke: '#333'
    });
    const redLine2 = appendSvgNode(svg2, 'line', undefined, {
      x1: graphStart,
      x2: graphStart,
      y1: '50',
      y2: '50',
      stroke: '#c33'
    });
    const blueLine2 = appendSvgNode(svg2, 'line', undefined, {
      x1: graphStart + ((graphEnd - graphStart) / 4),
      x2: graphStart + ((graphEnd - graphStart) / 4),
      y1: '50',
      y2: 50 - graphHeight,
      stroke: '#33c'
    });
    let sinePath = `M ${graphStart} 50`;
    for (let step = 0; step <= 100; step++) {
      const y = Math.round((50 + -(Math.sin(step / 100 * Math.PI * 2) * graphHeight)) * 10) / 10;
      const x = Math.round((graphStart + ((graphEnd - graphStart) * (step / 100))) * 10) / 10;
      sinePath += ` L ${x} ${y}`;
    }
    appendSvgNode(svg2, 'path', undefined, {
      d: sinePath,
      stroke: '#333',
      fill: 'none'
    })

    makeSvgArrowDraggable(svg1, arrow, marker, (pos) => {
      const arrowX = arrow.getAttribute('x2');
      const arrowY = arrow.getAttribute('y2');
      redLine.setAttribute('x1', arrowX);
      redLine.setAttribute('x2', arrowX);
      redLine.setAttribute('y2', arrowY);
      blueLine.setAttribute('x2', arrowX);
      let angle = svgPosToAngle(pos);
      if (angle < 0)
        angle += Math.PI * 2;
      redLine2.setAttribute('y2', Math.round((50 + -(Math.sin(angle) * graphHeight)) * 10) / 10);
      blueLine2.setAttribute('y2', Math.round((50 + -(Math.cos(angle) * graphHeight)) * 10) / 10);
      const redX = Math.round((graphStart + ((graphEnd - graphStart) * (angle / (Math.PI * 2)))) * 10) / 10;
      redLine2.setAttribute('x1', redX);
      redLine2.setAttribute('x2', redX);
      angle += Math.PI / 2;
      if (angle > Math.PI * 2)
        angle -= Math.PI * 2;
      const blueX = Math.round((graphStart + ((graphEnd - graphStart) * (angle / (Math.PI * 2)))) * 10) / 10;
      blueLine2.setAttribute('x1', blueX);
      blueLine2.setAttribute('x2', blueX);
    });
  }
</script>

<p>Using the interactive graph below, you can try to determine empirically if this is still true for the complex sine and cosine. Use your mouse (or finger on a mobile device) to drag the black point <span style="color:#333">⬤</span><span class="katex" style="font-size:1.1em"><span class="base"><span class="strut" style="height: 0.4306em;"></span><span class="mord mathnormal" style="margin-right: 0.044em;">z</span></span></span> all over the complex plane, and see what happens to <span style="color:#822">⬤</span><span class="katex" style="font-size:1.1em"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mop">sin</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right: 0.044em;">z</span><span class="mclose">)</span></span></span>, <span style="color:#228">⬤</span><span class="katex" style="font-size:1.1em"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mop">cos</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right: 0.044em;">z</span><span class="mclose">)</span></span></span>, <span style="color:#c33">⬤</span><span class="katex" style="font-size:1.1em"><span class="base"><span class="strut" style="height: 1.1219em; vertical-align: -0.25em;"></span><span class="mop"><span class="mop">sin</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.8719em;"><span style="top: -3.1208em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right: 0.044em;">z</span><span class="mclose">)</span></span></span>, <span style="color:#33c">⬤</span><span class="katex" style="font-size:1.1em"><span class="base"><span class="strut" style="height: 1.1141em; vertical-align: -0.25em;"></span><span class="mop"><span class="mop">cos</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.8641em;"><span style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right: 0.044em;">z</span><span class="mclose">)</span></span></span>, and <span style="color:#a3a">⬤</span><span class="katex" style="font-size:1.1em"><span class="base"><span class="strut" style="height: 1.1219em; vertical-align: -0.25em;"></span><span class="mop"><span class="mop">sin</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.8719em;"><span style="top: -3.1208em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right: 0.044em;">z</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span class="base"><span class="strut" style="height: 1.1141em; vertical-align: -0.25em;"></span><span class="mop"><span class="mop">cos</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.8641em;"><span style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right: 0.044em;">z</span><span class="mclose">)</span></span></span>.</p>

<p>
  <svg id='complex_pythag' style='max-width: 37em; aspect-ratio: 1; border: 1px solid #aaa' viewbox='0 0 100 100'></svg>
</p>

<script>
  'use strict';

  function moveSvgCircle(circle, pos) {
    circle.setAttribute('cx', pos.svgX);
    circle.setAttribute('cy', pos.svgY);
  }

  function svgCirclePos(circle) {
    return {
      svgX: Number(circle.getAttribute('cx')),
      svgY: Number(circle.getAttribute('cy'))
    }
  }

  function makeSvgCircleDraggable(svg, circle, callback) {
    let dragging = false;
    let startPos, circlePos, children;
    if (Array.isArray(circle)) {
      children = circle;
      circle = children.shift();
    }

    function startDrag(event) {
      dragging = true;
      startPos = mousePosToSvgPos(event, svg);
      circlePos = svgCirclePos(circle);
      return false;
    }
    function touchStartDrag(event) {
      if (!dragging) {
        const touchPos = mousePosToSvgPos(event, svg);
        circlePos = svgCirclePos(circle);
        if (svgPosDistance(touchPos, circlePos) < 5.5)
          startDrag(event);
      }
    }
    function drag(event) {
      if (dragging) {
        const dragPos = mousePosToSvgPos(event, svg);
        const newPos = {
          svgX: Math.round((circlePos.svgX + dragPos.svgX - startPos.svgX) * 10) / 10,
          svgY: Math.round((circlePos.svgY + dragPos.svgY - startPos.svgY) * 10) / 10
        };
        moveSvgCircle(circle, newPos);
        if (callback)
          callback(newPos);
        event.preventDefault(); // Suppress scrolling of page on mobile
        return false;
      }
    }
    function endDrag(event) {
      dragging = false;
    }
    circle.listen('mousedown', startDrag);
    circle.classList.add('draggable');
    if (children) {
      for (const child of children) {
        child.listen('mousedown', startDrag);
        child.classList.add('draggable');
      }
    }
    svg.listen('mousemove', drag);
    svg.listen('mouseup', endDrag)
    svg.listen('mouseleave', endDrag);
    svg.listen('touchstart', touchStartDrag, { passive: false });
    svg.listen('touchmove', drag, { passive: false });
    svg.listen('touchend', endDrag);
    svg.listen('touchleave', endDrag);
    svg.listen('touchcancel', endDrag);
  }

  {
    const svg = $id('complex_pythag');
    const scale = 4; // Total width/height of SVG in function domain units
    const darkRedDot = appendSvgNode(svg, 'circle', undefined, {
      r: '3',
      fill: '#822'
    });
    const redDot = appendSvgNode(svg, 'circle', undefined, {
      r: '3',
      fill: '#c33'
    });
    const darkBlueDot = appendSvgNode(svg, 'circle', undefined, {
      r: '3',
      fill: '#228'
    });
    const blueDot = appendSvgNode(svg, 'circle', undefined, {
      r: '3',
      fill: '#33c'
    });
    const purpleDot = appendSvgNode(svg, 'circle', undefined, {
      r: '3',
      fill: '#a3a'
    });
    const blackDot = appendSvgNode(svg, 'circle', undefined, {
      r: '3',
      fill: '#333'
    });
    const handIcon = appendSvgNode(svg, 'path', undefined, {
      style: 'fill: none; stroke: #fff; stroke-width: 0.2',
      d: 'M -1 0.65 v -2.41 c 0.01 -0.19 0.14 -0.29 0.29 -0.29 c 0.15 0 0.34 0.2 0.34 0.34 v 1.41 v -1.89 c -0 -0.15 0.14 -0.27 0.27 -0.27 c 0.14 0 0.31 0.15 0.31 0.31 v 1.85 v -1.58 c -0 -0.11 0.22 -0.23 0.36 -0.21 c 0.14 0.02 0.26 0.14 0.26 0.31 v 1.59 v -1.09 c -0 -0.13 0.2 -0.21 0.34 -0.19 c 0.14 0.02 0.23 0.15 0.23 0.31 v 2.33 c 0 0.13 -0 0.34 -0.04 0.52 c -0.04 0.18 -0.12 0.26 -0.25 0.38 c -0.13 0.11 -0.33 0.22 -0.48 0.28 c -0.15 0.06 -0.23 0.08 -0.41 0.09 c -0.18 0 -0.45 -0.03 -0.64 -0.12 c -0.19 -0.09 -0.43 -0.33 -0.48 -0.39 c -0.08 -0.1 -1.19 -1.69 -1.19 -1.69 c -0.06 -0.1 -0.01 -0.37 0.13 -0.45 c 0.13 -0.07 0.36 0.01 0.44 0.13 z'
    });

    prependSvgNode(svg, 'line', undefined, {
      x1: '50', x2: '50', y1: '0', y2: '100', stroke: '#111', "stroke-width": '0.3'
    });
    prependSvgNode(svg, 'line', undefined, {
      y1: '50', y2: '50', x1: '0', x2: '100', stroke: '#111', "stroke-width": '0.3'
    });
    prependSvgNode(svg, 'line', undefined, {
      x1: '25', x2: '25', y1: '45', y2: '55', stroke: '#111', "stroke-width": '0.3'
    });
    prependSvgNode(svg, 'line', undefined, {
      x1: '25', x2: '25', y1: '0', y2: '100', stroke: '#888', "stroke-width": '0.2'
    });
    prependSvgNode(svg, 'text', 'axislabel', { x: '25.3', y: '49.5' }).textContent = '-1';
    prependSvgNode(svg, 'line', undefined, {
      x1: '75', x2: '75', y1: '45', y2: '55', stroke: '#111', "stroke-width": '0.3'
    });
    prependSvgNode(svg, 'line', undefined, {
      x1: '75', x2: '75', y1: '0', y2: '100', stroke: '#888', "stroke-width": '0.2'
    });
    prependSvgNode(svg, 'text', 'axislabel', { x: '75.3', y: '49.5' }).textContent = '1';
    prependSvgNode(svg, 'line', undefined, {
      y1: '25', y2: '25', x1: '45', x2: '55', stroke: '#111', "stroke-width": '0.3'
    });
    prependSvgNode(svg, 'line', undefined, {
      y1: '25', y2: '25', x1: '0', x2: '100', stroke: '#888', "stroke-width": '0.2'
    });
    prependSvgNode(svg, 'text', 'axislabel', { x: '50.5', y: '24.3' }).textContent = 'i';
    prependSvgNode(svg, 'line', undefined, {
      y1: '75', y2: '75', x1: '45', x2: '55', stroke: '#111', "stroke-width": '0.3'
    });
    prependSvgNode(svg, 'line', undefined, {
      y1: '75', y2: '75', x1: '0', x2: '100', stroke: '#888', "stroke-width": '0.2'
    });
    prependSvgNode(svg, 'text', 'axislabel', { x: '50.5', y: '74.3' }).textContent = '-i';
    const halfPiDist = Math.PI/scale*50;
    prependSvgNode(svg, 'line', undefined, {
      x1: String(50 - halfPiDist), x2: String(50 - halfPiDist), y1: '45', y2: '55', stroke: '#111', "stroke-width": '0.3'
    });
    prependSvgNode(svg, 'line', undefined, {
      x1: String(50 - halfPiDist), x2: String(50 - halfPiDist), y1: '0', y2: '100', stroke: '#888', "stroke-width": '0.2'
    });
    prependSvgNode(svg, 'text', 'axislabel', { x: String(50 - halfPiDist + 0.3), y: '49.5' }).textContent = '-π/2';
    prependSvgNode(svg, 'line', undefined, {
      x1: String(50 + halfPiDist), x2: String(50 + halfPiDist), y1: '45', y2: '55', stroke: '#111', "stroke-width": '0.3'
    });
    prependSvgNode(svg, 'line', undefined, {
      x1: String(50 + halfPiDist), x2: String(50 + halfPiDist), y1: '0', y2: '100', stroke: '#888', "stroke-width": '0.2'
    });
    prependSvgNode(svg, 'text', 'axislabel', { x: String(50 + halfPiDist + 0.3), y: '49.5' }).textContent = 'π/2';
    prependSvgNode(svg, 'line', undefined, {
      y1: String(50 - halfPiDist), y2: String(50 - halfPiDist), x1: '45', x2: '55', stroke: '#111', "stroke-width": '0.3'
    });
    prependSvgNode(svg, 'line', undefined, {
      y1: String(50 - halfPiDist), y2: String(50 - halfPiDist), x1: '0', x2: '100', stroke: '#888', "stroke-width": '0.2'
    });
    prependSvgNode(svg, 'text', 'axislabel', { x: '50.5', y: String(50 - halfPiDist - 0.7) }).textContent = 'iπ/2';
    prependSvgNode(svg, 'line', undefined, {
      y1: String(50 + halfPiDist), y2: String(50 + halfPiDist), x1: '45', x2: '55', stroke: '#111', "stroke-width": '0.3'
    });
    prependSvgNode(svg, 'line', undefined, {
      y1: String(50 + halfPiDist), y2: String(50 + halfPiDist), x1: '0', x2: '100', stroke: '#888', "stroke-width": '0.2'
    });
    prependSvgNode(svg, 'text', 'axislabel', { x: '50.5', y: String(50 + halfPiDist - 0.7) }).textContent = '-iπ/2';

    function svgPosToComplex(pos) {
      return new Complex([(pos.svgX / 100 * scale) - (scale / 2), -(pos.svgY / 100 * scale) + (scale / 2)]);
    }

    function complexToSvgPos(z) {
      const re = z.re, im = z.im;
      return {
        svgX: (re / scale * 100) + 50,
        svgY: -(im / scale * 100) + 50
      };
    }

    function moveCircle(circle, z) {
      moveSvgCircle(circle, complexToSvgPos(z));
      let title = circle.$tag1('title');
      if (!title)
        title = appendSvgNode(circle, 'title');
      z = new Complex(Math.round(z.re * 100) / 100, Math.round(z.im * 100) / 100); // Round to 2 places
      title.textContent = z.toString();
    }

    function updateComplexPythag(dotPos) {
      moveSvgCircle(blackDot, dotPos);
      handIcon.setAttribute('transform', `translate(${dotPos.svgX} ${dotPos.svgY})`);
      const z = svgPosToComplex(dotPos);
      moveCircle(darkRedDot, z.sin());
      moveCircle(redDot, z.sin().pow(2));
      moveCircle(darkBlueDot, z.cos());
      moveCircle(blueDot, z.cos().pow(2));
      moveCircle(purpleDot, z.sin().pow(2).add(z.cos().pow(2)));
    }

    updateComplexPythag({svgX: 25, svgY: 70});

    makeSvgCircleDraggable(svg, [blackDot, handIcon], updateComplexPythag);
  }
</script>

<p>What do you conclude? Does it seem that <span class="katex" style="font-size:1.1em"><span class="base"><span class="strut" style="height: 1.1219em; vertical-align: -0.25em;"></span><span class="mop"><span class="mop">sin</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.8719em;"><span style="top: -3.1208em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">z</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span class="base"><span class="strut" style="height: 1.1141em; vertical-align: -0.25em;"></span><span class="mop"><span class="mop">cos</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.8641em;"><span style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">z</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 0.6444em;"></span><span class="mord">1</span></span></span> holds?</p>

<div class='hidden reveal'>
<p>The identity definitely still holds; that’s why the purple point stays fixed at 1 no matter where you move the black point. However, please note that in the complex case, <span class="katex" style="font-size:1.1em"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mop">sin</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right: 0.044em;">z</span><span class="mclose">)</span></span></span> and <span class="katex" style="font-size:1.1em"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mop">cos</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right: 0.044em;">z</span><span class="mclose">)</span></span></span> do <i>not</i> represent the lengths of the sides of a right triangle!</p>
<p>Algebraically, we can derive this result from the exponential definitions of the two functions:</p>
<p style='text-align: center'>
  <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 11.3264em; vertical-align: -5.4132em;"></span><span class="mord"><span class="mtable"><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 5.9132em;"><span style="top: -7.9132em;"><span class="pstrut" style="height: 3.654em;"></span><span class="mord"><span class="mop"><span class="mop">sin</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.8719em;"><span style="top: -3.1208em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right: 0.044em;">z</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mop"><span class="mop">cos</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.8641em;"><span style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right: 0.044em;">z</span><span class="mclose">)</span></span></span><span style="top: -5.3417em;"><span class="pstrut" style="height: 3.654em;"></span><span class="mord"></span></span><span style="top: -3.0343em;"><span class="pstrut" style="height: 3.654em;"></span><span class="mord"></span></span><span style="top: -0.7268em;"><span class="pstrut" style="height: 3.654em;"></span><span class="mord"></span></span><span style="top: 1.0992em;"><span class="pstrut" style="height: 3.654em;"></span><span class="mord"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 5.4132em;"></span></span></span></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 5.9132em;"><span style="top: -7.9132em;"><span class="pstrut" style="height: 3.654em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mord"><span class="delimsizing size3">(</span></span><span class="mord"><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.5017em;"><span style="top: -2.314em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord">2</span><span class="mord mathnormal">i</span></span></span><span style="top: -3.23em;"><span class="pstrut" style="height: 3em;"></span><span class="frac-line" style="border-bottom-width: 0.04em;"></span></span><span style="top: -3.677em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal">e</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.8247em;"><span style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mord mathnormal mtight" style="margin-right: 0.044em;">z</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mord"><span class="mord mathnormal">e</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.8247em;"><span style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mathnormal mtight">i</span><span class="mord mathnormal mtight" style="margin-right: 0.044em;">z</span></span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.686em;"></span></span></span></span><span class="mclose nulldelimiter"></span></span></span><span class="mord"><span class="mord"><span class="delimsizing size3">)</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 1.654em;"><span style="top: -3.9029em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mord"><span class="delimsizing size3">(</span></span><span class="mord"><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.5017em;"><span style="top: -2.314em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord">2</span></span></span><span style="top: -3.23em;"><span class="pstrut" style="height: 3em;"></span><span class="frac-line" style="border-bottom-width: 0.04em;"></span></span><span style="top: -3.677em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal">e</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.8247em;"><span style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">
  <span class="mord mathnormal mtight">i</span><span class="mord mathnormal mtight" style="margin-right: 0.044em;">z</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mord"><span class="mord mathnormal">e</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.8247em;"><span style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mathnormal mtight">i</span><span class="mord mathnormal mtight" style="margin-right: 0.044em;">z</span></span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.686em;"></span></span></span></span><span class="mclose nulldelimiter"></span></span></span><span class="mord"><span class="mord"><span class="delimsizing size3">)</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 1.654em;"><span style="top: -3.9029em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span><span style="top: -5.3417em;"><span class="pstrut" style="height: 3.654em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mord">−</span><span class="mord"><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.3214em;"><span style="top: -2.314em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord">4</span></span></span><span style="top: -3.23em;"><span class="pstrut" style="height: 3em;"></span><span class="frac-line" style="border-bottom-width: 0.04em;"></span></span><span style="top: -3.677em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.686em;"></span></span></span></span><span class="mclose nulldelimiter"></span></span></span><span class="mord"><span class="delimsizing size1">(</span></span><span class="mord"><span class="mord mathnormal">e</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.8747em;"><span style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mord mathnormal mtight" style="margin-right: 0.044em;">z</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mord"><span class="mord mathnormal">e</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.8747em;"><span style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mathnormal mtight">i</span><span class="mord mathnormal mtight" style="margin-right: 0.044em;">z</span></span></span></span></span></span></span></span></span><span class="mord"><span class="mord"><span class="delimsizing size1">)</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 1.054em;"><span style="top: -3.3029em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mord"><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.3214em;"><span style="top: -2.314em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord">4</span></span></span><span style="top: -3.23em;"><span class="pstrut" style="height: 3em;"></span><span class="frac-line" style="border-bottom-width: 0.04em;"></span></span><span style="top: -3.677em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.686em;"></span></span></span></span><span class="mclose nulldelimiter"></span></span></span><span class="mord"><span class="delimsizing size1">(</span></span><span class="mord"><span class="mord mathnormal">e</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.8747em;"><span style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mord mathnormal mtight" style="margin-right: 0.044em;">z</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mord"><span class="mord mathnormal">e</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.8747em;"><span style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mathnormal mtight">i</span><span class="mord mathnormal mtight" style="margin-right: 0.044em;">z</span></span></span></span></span></span></span></span></span><span class="mord"><span class="mord"><span class="delimsizing size1">)</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 1.054em;"><span style="top: -3.3029em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span><span style="top: -3.0343em;"><span class="pstrut" style="height: 3.654em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mord">−</span><span class="mord"><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.3214em;"><span style="top: -2.314em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord">4</span></span></span><span style="top: -3.23em;"><span class="pstrut" style="height: 3em;"></span><span class="frac-line" style="border-bottom-width: 0.04em;"></span></span><span style="top: -3.677em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.686em;"></span></span></span></span><span class="mclose nulldelimiter"></span></span></span><span class="mord"><span class="delimsizing size1">(</span></span><span class="mord"><span class="mord mathnormal">e</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.8747em;"><span style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span><span class="mord mathnormal mtight">i</span><span class="mord mathnormal mtight" style="margin-right: 0.044em;">z</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mord"><span class="mord mathnormal">e</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.8747em;"><span style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight">2</span><span class="mord mathnormal mtight">i</span><span class="mord mathnormal mtight" style="margin-right: 0.044em;">z</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mord">2</span><span class="mord"><span class="delimsizing size1">)</span></span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mord"><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.3214em;"><span style="top: -2.314em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord">4</span></span></span><span style="top: -3.23em;"><span class="pstrut" style="height: 3em;"></span><span class="frac-line" style="border-bottom-width: 0.04em;"></span></span><span style="top: -3.677em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.686em;"></span></span></span></span><span class="mclose nulldelimiter"></span></span></span><span class="mord"><span class="delimsizing size1">(</span></span><span class="mord"><span class="mord mathnormal">e</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.8747em;"><span style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span><span class="mord mathnormal mtight">i</span><span class="mord mathnormal mtight" style="margin-right: 0.044em;">z</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mord"><span class="mord mathnormal">e</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.8747em;"><span style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight">2</span><span class="mord mathnormal mtight">i</span><span class="mord mathnormal mtight" style="margin-right: 0.044em;">z</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mord">2</span><span class="mord"><span class="delimsizing size1">)</span></span></span></span><span style="top: -0.7268em;"><span class="pstrut" style="height: 3.654em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mord">−</span><span class="mord"><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.3214em;"><span style="top: -2.314em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord">4</span></span></span><span style="top: -3.23em;"><span class="pstrut" style="height: 3em;"></span><span class="frac-line" style="border-bottom-width: 0.04em;"></span></span><span style="top: -3.677em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.686em;"></span></span></span></span><span class="mclose nulldelimiter"></span></span></span><span class="mopen">(</span><span class="mord">−</span><span class="mord">2</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mord"><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.3214em;"><span style="top: -2.314em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord">4</span></span></span><span style="top: -3.23em;"><span class="pstrut" style="height: 3em;"></span><span class="frac-line" style="border-bottom-width: 0.04em;"></span></span><span style="top: -3.677em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.686em;"></span></span></span></span><span class="mclose nulldelimiter"></span></span></span><span class="mopen">(</span><span class="mord">2</span><span class="mclose">)</span></span></span><span style="top: 1.0992em;"><span class="pstrut" style="height: 3.654em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 5.4132em;"></span></span></span></span></span></span></span></span></span>
</p>
</div>

<h2>4. Is <span class="katex" style="font-size:1.1em"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mop">cos</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right: 0.044em;">z</span><span class="mclose">)</span></span></span> even, and <span class="katex" style="font-size:1.1em"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mop">sin</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right: 0.044em;">z</span><span class="mclose">)</span></span></span> odd?</h2>

<p>First, we need to think about what “even” and “odd” means in this context. For a real function, “even” means that the function is unchanged by reflecting across the y-axis, and “odd” means the function is negated by reflecting across the y-axis:</p>

<div style='margin-block-start: 1em; margin-block-end: 1em'>
  <div style='display: flex; flex-direction: row; flex-wrap: wrap; gap: .5em'>
    <div id='real_sine_odd' style='position: relative; width: 24em; height: 20em; cursor: pointer'>
      <div class="graphlabel"><span class="katex" style="font-size:1.1em"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mop">sin</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right: 0.044em;">x</span><span class="mclose">)</span></span></span> is <span style="font-weight: bold">odd</span></div>
    </div>
    <div id='real_cosine_even' style='position: relative; width: 24em; height: 20em; cursor: pointer'>
      <div class="graphlabel"><span class="katex" style="font-size:1.1em"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mop">cos</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right: 0.044em;">x</span><span class="mclose">)</span></span></span> is <span style="font-weight: bold">even</span></div>
    </div>
  </div>
  <small><i>Click (or tap) to flip the functions over like a couple of pancakes</i></small>
</div>

<script type='module'>
  import * as THREE from 'three';
  import { LineMaterial } from '/assets/js/LineMaterial.js';
  import { LineGeometry } from '/assets/js/LineGeometry.js';

  if (window.hasWebGL) {

  const viewport1 = $id('real_sine_odd');
  const viewport2 = $id('real_cosine_even');

  function showGraph(viewport, fn) {
    const range = Math.PI * 6;
    const samples = (new Array(30)).fill(undefined).map((_, i, ary) => {
      let x = (i/(ary.length-1))*range - (range / 2);
      return new THREE.Vector2(x, fn(x));
    });
    const curve = new THREE.SplineCurve(samples);

    let viewWidth = viewport.clientWidth, viewHeight = viewport.clientHeight;

    const scene = new THREE.Scene;
    scene.background = new THREE.Color('#121212');

    const camera = new THREE.PerspectiveCamera(45, viewWidth / viewHeight, 1, 1000);
    camera.position.set(0, 11, 0);
    camera.setRotationFromQuaternion(new THREE.Quaternion(-0.707, 0, 0, 0.707));

    const line = new LineGeometry;
    const linePositions = [];
    const point = new THREE.Vector3;
    for (let i = 0; i <= 70; i++) {
      curve.getPoint(i / 70, point);
      linePositions.push(point.x / 2, 0, point.y);
    }
    line.setPositions(linePositions);
    scene.add(new THREE.Mesh(line, new LineMaterial({ color: 0xff0000, linewidth: 0.005 })));

    const grid = []
    function straightLine(x1, y1, x2, y2) {
      const gridLine = new LineGeometry;
      gridLine.setPositions([x1, 0, y1, x2, 0, y2]);
      grid.push(gridLine);
      scene.add(new THREE.Mesh(gridLine, new LineMaterial({ color: 0xffffff, linewidth: 0.002 })));
    }
    straightLine(-Math.PI * 1.5, 0, Math.PI * 1.5, 0);
    straightLine(0, 2.5, 0, -2.5);
    straightLine(-Math.PI * 0.5, 2.5, -Math.PI * 0.5, -2.5);
    straightLine(-Math.PI, 2.5, -Math.PI, -2.5);
    straightLine(Math.PI * 0.5, 2.5, Math.PI * 0.5, -2.5);
    straightLine(Math.PI, 2.5, Math.PI, -2.5);
    straightLine(-Math.PI * 1.5, 2.5, Math.PI * 1.5, 2.5);
    straightLine(-Math.PI * 1.5, -2.5, Math.PI * 1.5, -2.5);
    straightLine(-Math.PI * 1.5, 2.5, -Math.PI * 1.5, -2.5);
    straightLine(Math.PI * 1.5, 2.5, Math.PI * 1.5, -2.5);

    const renderer = new THREE.WebGLRenderer({ antialias: true });
    renderer.setPixelRatio(window.devicePixelRatio);
    renderer.setSize(viewWidth, viewHeight);
    viewport.appendChild(renderer.domElement);

    renderer.render(scene, camera);

    let redrawNeeded = false;
    function redrawIfNeeded() {
      if (redrawNeeded)
        renderer.render(scene, camera);
      redrawNeeded = false;
    }

    new ResizeObserver(function() {
      viewWidth = viewport.clientWidth;
      viewHeight = viewport.clientHeight;
      renderer.setSize(viewWidth, viewHeight);
      redrawNeeded = true;
      setTimeout(redrawIfNeeded, 80);
    }).observe(viewport);

    return function rotateGraph(angle) {
      line.rotateZ(angle);
      for (const gridLine of grid)
        gridLine.rotateZ(angle);
      renderer.render(scene, camera);
    }
  }

  const rotateSin = showGraph(viewport1, Math.sin);
  const rotateCos = showGraph(viewport2, Math.cos);

  let targetRotation = 0, prevTimestamp;

  function rotateGraphs(timestamp) {
    if (targetRotation > 0) {
      const elapsed = timestamp - prevTimestamp;
      const rotation = Math.min(elapsed * Math.PI / 400, targetRotation);
      rotateSin(rotation);
      rotateCos(rotation);
      targetRotation -= rotation;
      if (targetRotation > 0) {
        prevTimestamp = timestamp;
        requestAnimationFrame(rotateGraphs);
      }
    }
  }

  for (const viewport of [viewport1, viewport2]) {
    viewport.listen('click', () => {
      if (targetRotation <= 0) {
        prevTimestamp = document.timeline.currentTime;
        requestAnimationFrame(rotateGraphs);
      }
      targetRotation += Math.PI;
    });
  }

  }
</script>

<p>For a complex function, the analogous operation is to reflect each point in the input space across the origin; instead of <span class="katex" style="font-size:1.1em"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathnormal" style="margin-right: 0.1076em;">f</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right: 0.044em;">z</span><span class="mclose">)</span></span></span></span>, we take <span class="katex" style="font-size:1.1em"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathnormal" style="margin-right: 0.1076em;">f</span><span class="mopen">(</span><span class="mord">−</span><span class="mord mathnormal" style="margin-right: 0.044em;">z</span><span class="mclose">)</span></span></span></span>.
</p>

<p>If the complex sine is odd, meaning that <span class="katex" style="font-size:1.1em"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mop">sin</span><span class="mopen">(</span><span class="mord">−</span><span class="mord mathnormal" style="margin-right: 0.044em;">z</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord">−</span><span class="mop">sin</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right: 0.044em;">z</span><span class="mclose">)</span></span></span></span>, we should be able to take a vertical slice of its graph in <i>any</i> direction (though the slice must go through the origin), and just like the above graph of the real sine, the path it traces out on the left and right sides of the origin should be mirrored and “upside down” relative to each other.</p>

<p>To check this property empirically, let’s actually take some slices and see how they look! The 3D graph below plots the real part of the complex sine; move the slider to rotate the graph and take a slice at a different angle.</p>

<div style='margin-block-start: 1em; margin-block-end: 1em'>
  <div id='complex_sine_odd' style='width: 100%; max-width: 35rem; max-height: 35rem; aspect-ratio: 1; display: inline-block; margin-right: .5em; cursor: move'>
    <canvas style='width: 100%; height: 100%'></canvas>
  </div>
  <input type='range' id='slicepos' min='0' max='100' value='50' class='rotation-slider' />
</div>

<script type='module'>
  import * as THREE from 'three';
  import { OrbitControls } from '/assets/js/OrbitControls.js';
  import { LineMaterial } from '/assets/js/LineMaterial.js';
  import { LineGeometry } from '/assets/js/LineGeometry.js';

  if (window.hasWebGL) {

  const viewport = $id('complex_sine_odd');

  const resolution = 30;
  const [vertices, colors] = meshVerticesForFunction(resolution, (z) => z.sin().re, viridis);
  const indices = vertexIndicesForMesh(resolution);

  function showGraph(viewport, vertices, colors, setRotation) {
    let viewWidth = viewport.clientWidth, viewHeight = viewport.clientHeight;
    const canvas = viewport.$tag1('canvas');

    const scene = new THREE.Scene;
    scene.background = new THREE.Color('#121212');

    const camera = new THREE.PerspectiveCamera(45, viewWidth / viewHeight, 1, 1000);
    camera.position.set(0, 0, 25);

    const ambientLight = new THREE.AmbientLight(0xcccccc, 1);
    scene.add(ambientLight);

    const dirLight = new THREE.DirectionalLight(0xffffff, 3);
    dirLight.position.set(16, 18, 12);
    scene.add(dirLight);

    const geometry = new THREE.BufferGeometry;
    geometry.setIndex(indices);
    geometry.setAttribute('position', new THREE.BufferAttribute(vertices, 3));
    geometry.setAttribute('color', new THREE.BufferAttribute(colors, 4));
    geometry.computeVertexNormals();

    const material = new THREE.MeshPhongMaterial({
      side: THREE.DoubleSide, vertexColors: true, transparent: true, depthWrite: false
    });
    const mesh = new THREE.Mesh(geometry, material);
    scene.add(mesh);

    function createLine(from, to) {
      const material = new THREE.LineBasicMaterial({ color: 0xaaaaaa });
      const geometry = new THREE.BufferGeometry().setFromPoints([from, to]);
      return new THREE.Line(geometry, material);
    }

    const line1 = createLine(new THREE.Vector3(0, 5.5, 0), new THREE.Vector3(0, -5.5, 0));
    const line2 = createLine(new THREE.Vector3(5.5, 0, 0), new THREE.Vector3(-5.5, 0, 0));
    const line3 = createLine(new THREE.Vector3(5.5, 5.5, 0), new THREE.Vector3(-5.5, 5.5, 0));
    const line4 = createLine(new THREE.Vector3(5.5, -5.5, 0), new THREE.Vector3(-5.5, -5.5, 0));
    const line5 = createLine(new THREE.Vector3(5.5, 5.5, 0), new THREE.Vector3(5.5, -5.5, 0));
    const line6 = createLine(new THREE.Vector3(-5.5, 5.5, 0), new THREE.Vector3(-5.5, -5.5, 0));
    const lines = [line1, line2, line3, line4, line5, line6];
    const highlight = new LineGeometry;

    for (const line of lines)
      scene.add(line);
    scene.add(new THREE.Mesh(highlight, new LineMaterial({ color: 0xff0000, linewidth: 0.022 })));

    setRotation([mesh], highlight, 50);

    let redrawNeeded = false;
    function redrawIfNeeded() {
      if (redrawNeeded)
        useSharedRenderer(canvas, viewWidth, viewHeight, scene, camera);
      redrawNeeded = false;
    }
    function redraw() {
      redrawNeeded = true;
      setTimeout(redrawIfNeeded, 80);
    }

    redraw();

    const controls = new OrbitControls(camera, viewport);
    controls.addEventListener('change', redraw);

    new ResizeObserver(function() {
      viewWidth = viewport.clientWidth;
      viewHeight = viewport.clientHeight;
      redraw();
    }).observe(viewport);

    return function(t) {
      setRotation([mesh], highlight, t);
      redraw();
    }
  }

  const update = showGraph(viewport, vertices, colors, (objects, highlight, t) => {
    const rot = (t - 50) / 50 * (Math.PI / 2);
    for (const obj of objects)
      obj.rotation.set(0, rot, 0);

    const highlighted = [];
    for (let dist = -5.5; dist <= 5.5; dist += 0.03) {
      const re = dist * Math.cos(rot);
      const im = -dist * Math.sin(rot);
      const complex = new Complex(re, im);
      highlighted.push(dist, complex.sin().re / 2, 0);
    }
    highlight.setPositions(highlighted);
  });

  $id('slicepos').listen('input', (e) => update(Number(e.target.value)));

  }
</script>

<p>What do you conclude?</p>

<div class='reveal hidden'>
  <p>The complex sine is indeed “odd”. Although we didn’t repeat the experiment on the imaginary part of the complex sine, the conclusion would have been the same.</p>
  <p>And as you might expect, the complex cosine is “even” in the same sense (it maps to itself when each output point is reflected across the origin). Or: <span class="katex" style="font-size:1.1em"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mop">cos</span><span class="mopen">(</span><span class="mord">−</span><span class="mord mathnormal" style="margin-right: 0.044em;">z</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mop">cos</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right: 0.044em;">z</span><span class="mclose">)</span></span></span></span>.</p>
</div>

<h2>5. Are they identical after a π/2 phase shift?</h2>

<p>Here is an overlay of the magnitudes of the complex sine and cosine; move the slider to shift the cosine along the real axis, and try to see at what shift (if any) the graphs coincide exactly. To make things easier to see, I’ll only graph on one side of the real axis. Since the magnitudes of the two functions are symmetrical across the real axis, nothing is lost by only showing one side.</p>

<div style='margin-block-start: 1em; margin-block-end: 1em'>
  <canvas id='sine_cos_magnitude_overlay' style='width: 35em; height: 35em; display: inline-block; cursor: move'>
  </canvas>
  <input type='range' id='shiftpos' min='0' max='1.57' value='0' step='0.314' list='shiftticks' style='width: 100%' />
  <datalist id='shiftticks' style='display: flex; justify-content: space-between; width: 100%'>
    <option value='0' label='0'></option>
    <option value='0.314' label='π/10'></option>
    <option value='0.628' label='2π/10'></option>
    <option value='0.942' label='3π/10'></option>
    <option value='1.256' label='2π/5'></option>
    <option value='1.57' label='π/2'></option>
  </datalist>
</div>

<script type='module'>
  import * as THREE from 'three';
  import { OrbitControls } from '/assets/js/OrbitControls.js';

  if (window.hasWebGL) {

  const viewport = $id('sine_cos_magnitude_overlay');
  const resolution = 30;
  const [vertices1, colors1] = meshVerticesForFunction(resolution, (z) => z.sin().abs(), cool, 0, Math.PI * 1.2, Math.PI * 2.5, Math.PI * 0.8, 0, Math.PI * 0.4);
  const [vertices2, colors2] = meshVerticesForFunction(resolution, (z) => z.cos().abs(), cool, 0, Math.PI * 1.2, Math.PI * 2.5, Math.PI * 0.8, 0, Math.PI * 0.4);
  const indices = vertexIndicesForMesh(resolution);

  let viewWidth = viewport.clientWidth, viewHeight = viewport.clientHeight;

  const scene = new THREE.Scene;
  scene.background = new THREE.Color('#121212');

  const camera = new THREE.PerspectiveCamera(45, viewWidth / viewHeight, 1, 1000);
  camera.position.set(-5.49, 6.56, -6.56);
  camera.rotation.set(-2.51, -0.48, -2.81);

  const ambientLight = new THREE.AmbientLight(0xcccccc, 1);
  scene.add(ambientLight);

  const dirLight = new THREE.DirectionalLight(0xffffff, 5);
  dirLight.position.set(16, 18, 12);
  scene.add(dirLight);

  function buildGeometry(vertices, colors) {
    const geometry = new THREE.BufferGeometry;
    geometry.setIndex(indices);
    geometry.setAttribute('position', new THREE.BufferAttribute(vertices, 3));
    geometry.setAttribute('color', new THREE.BufferAttribute(colors, 4));
    geometry.computeVertexNormals();
    return geometry;
  }

  const material = new THREE.MeshPhongMaterial({
    side: THREE.DoubleSide, vertexColors: true, transparent: true, depthWrite: false
  });

  const mesh1 = new THREE.Mesh(buildGeometry(vertices1, colors1), material);
  scene.add(mesh1);
  const mesh2 = new THREE.Mesh(buildGeometry(vertices2, colors2), material);
  scene.add(mesh2);

  function createLine(from, to) {
    const material = new THREE.LineBasicMaterial({ color: 0xffffff });
    const geometry = new THREE.BufferGeometry().setFromPoints([from, to]);
    return new THREE.Line(geometry, material);
  }

  scene.add(createLine(new THREE.Vector3(1.5*Math.PI, 0, 0), new THREE.Vector3(-1.5*Math.PI, 0, 0)));
  scene.add(createLine(new THREE.Vector3(0, 1.5*Math.PI, 0), new THREE.Vector3(0, 0, 0)));
  scene.add(createLine(new THREE.Vector3(0, 0, 1.5*Math.PI), new THREE.Vector3(0, 0, 0)));

  let redrawNeeded = false;
  function redrawIfNeeded() {
    if (redrawNeeded)
      useSharedRenderer(viewport, viewWidth, viewHeight, scene, camera);
    redrawNeeded = false;
  }
  function redraw() {
    redrawNeeded = true;
    setTimeout(redrawIfNeeded, 80);
  }

  const controls = new OrbitControls(camera, viewport);
  controls.target.set(-0.42, 0.95, 1.08);
  controls.update();
  controls.addEventListener('change', redraw);

  function setCosPos(t) {
    mesh2.position.set(t, 0, 0);
    redraw();
  }

  $id('shiftpos').listen('input', (e) => setCosPos(Number(e.target.value)));

  setCosPos(0);

  new ResizeObserver(function() {
    viewWidth = viewport.clientWidth;
    viewHeight = viewport.clientHeight;
    redraw();
  }).observe(viewport);

  }
</script>

<p>And the same for the angles of the complex sine and cosine:</p>

<div style='margin-block-start: 1em; margin-block-end: 1em'>
  <canvas id='sine_cos_angle_overlay' style='width: 35em; height: 35em; display: inline-block; cursor: move'>
  </canvas>
  <input type='range' id='shiftpos2' min='0' max='1.57' value='0' step='0.314' list='shiftticks2' style='width: 100%' />
  <datalist id='shiftticks2' style='display: flex; justify-content: space-between; width: 100%'>
    <option value='0' label='0'></option>
    <option value='0.314' label='π/10'></option>
    <option value='0.628' label='2π/10'></option>
    <option value='0.942' label='3π/10'></option>
    <option value='1.256' label='2π/5'></option>
    <option value='1.57' label='π/2'></option>
  </datalist>
</div>

<script type='module'>
  import * as THREE from 'three';
  import { OrbitControls } from '/assets/js/OrbitControls.js';

  if (window.hasWebGL) {

  const viewport = $id('sine_cos_angle_overlay');
  const resolution = 30;
  const [vertices1, colors1] = meshVerticesForFunction(resolution, (z) => z.sin().arg(), warm, -Math.PI, Math.PI, Math.PI, Math.PI);
  const [vertices2, colors2] = meshVerticesForFunction(resolution, (z) => z.cos().arg(), warm, -Math.PI, Math.PI, Math.PI, Math.PI);
  const indices = vertexIndicesForMesh(resolution);

  let viewWidth = viewport.clientWidth, viewHeight = viewport.clientHeight;

  const scene = new THREE.Scene;
  scene.background = new THREE.Color('#121212');

  const camera = new THREE.PerspectiveCamera(45, viewWidth / viewHeight, 1, 1000);
  camera.position.set(3.57, 2.86, 5.91);
  camera.rotation.set(-0.43, 0.45, 0.2);

  const ambientLight = new THREE.AmbientLight(0xcccccc, 1);
  scene.add(ambientLight);

  const dirLight = new THREE.DirectionalLight(0xffffff, 3);
  dirLight.position.set(16, 18, 12);
  scene.add(dirLight);

  const geometry1 = new THREE.BufferGeometry;
  geometry1.setIndex(indices);
  geometry1.setAttribute('position', new THREE.BufferAttribute(vertices1, 3));
  geometry1.setAttribute('color', new THREE.BufferAttribute(colors1, 4));
  geometry1.computeVertexNormals();

  const geometry2 = new THREE.BufferGeometry;
  geometry2.setIndex(indices);
  geometry2.setAttribute('position', new THREE.BufferAttribute(vertices2, 3));
  geometry2.setAttribute('color', new THREE.BufferAttribute(colors2, 4));
  geometry2.computeVertexNormals();

  const material = new THREE.MeshPhongMaterial({
    side: THREE.DoubleSide, vertexColors: true, transparent: true, depthWrite: false
  });

  const mesh1 = new THREE.Mesh(geometry1, material);
  scene.add(mesh1);
  const mesh2 = new THREE.Mesh(geometry2, material)
  scene.add(mesh2);

  function createLine(from, to) {
    const material = new THREE.LineBasicMaterial({ color: 0xffffff });
    const geometry = new THREE.BufferGeometry().setFromPoints([from, to]);
    return new THREE.Line(geometry, material);
  }

  scene.add(createLine(new THREE.Vector3(Math.PI*0.6, 0, 0), new THREE.Vector3(-Math.PI*0.6, 0, 0)));
  scene.add(createLine(new THREE.Vector3(0, Math.PI*0.6, 0), new THREE.Vector3(0, -Math.PI*0.6, 0)));
  scene.add(createLine(new THREE.Vector3(0, 0, Math.PI*0.6), new THREE.Vector3(0, 0, -Math.PI*0.6)));

  let redrawNeeded = false;
  function redrawIfNeeded() {
    if (redrawNeeded)
      useSharedRenderer(viewport, viewWidth, viewHeight, scene, camera);
    redrawNeeded = false;
  }
  function redraw() {
    redrawNeeded = true;
    setTimeout(redrawIfNeeded, 80);
  }

  const controls = new OrbitControls(camera, viewport);
  controls.target.set(0.31, 0, -0.21);
  controls.update();
  controls.addEventListener('change', redraw);

  function setCosPos(t) {
    mesh2.position.set(t, 0, 0);
    redraw();
  }

  $id('shiftpos2').listen('input', (e) => setCosPos(Number(e.target.value)));

  setCosPos(0);

  new ResizeObserver(function() {
    viewWidth = viewport.clientWidth;
    viewHeight = viewport.clientHeight;
    redraw();
  }).observe(viewport);

  }
</script>

<p>What do you conclude?</p>

<p class='reveal hidden'>Yes, shifting the (complex) cosine along the real axis by π/2 gives the (complex) sine. While the above visualizations just demonstrate this property over a small, finite part of the complex plane, it is also true everywhere else.</p>

<h2>6. Do their derivatives still work in the same way?</h2>

<p>Algebraically, it’s pretty obvious that we still have <span class="katex" style="font-size:1.1em"><span class="base"><span class="strut" style="height: 1.2251em; vertical-align: -0.345em;"></span><span class="mord"><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.8801em;"><span style="top: -2.655em;"><span class="pstrut" style="height: 3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">d</span><span class="mord mathnormal mtight">z</span></span></span></span><span style="top: -3.23em;"><span class="pstrut" style="height: 3em;"></span><span class="frac-line" style="border-bottom-width: 0.04em;"></span></span><span style="top: -3.394em;"><span class="pstrut" style="height: 3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">d</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.345em;"></span></span></span></span><span class="mclose nulldelimiter"></span></span></span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mop">sin</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right: 0.044em;">z</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mop">cos</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right: 0.044em;">z</span><span class="mclose">)</span></span></span>, <span class="katex" style="font-size:1.1em"><span class="base"><span class="strut" style="height: 1.2251em; vertical-align: -0.345em;"></span><span class="mord"><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.8801em;"><span style="top: -2.655em;"><span class="pstrut" style="height: 3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">d</span><span class="mord mathnormal mtight">z</span></span></span></span><span style="top: -3.23em;"><span class="pstrut" style="height: 3em;"></span><span class="frac-line" style="border-bottom-width: 0.04em;"></span></span><span style="top: -3.394em;"><span class="pstrut" style="height: 3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">d</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.345em;"></span></span></span></span><span class="mclose nulldelimiter"></span></span></span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mop">cos</span><span class="mopen">(</span><span class="mord mathnormal">z</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord">−</span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mop">sin</span><span class="mopen">(</span><span class="mord mathnormal">z</span><span class="mclose">)</span></span></span>. Just look at the <a href="#powerseries">power series definitions</a> (<i>or</i> the <a href="https://en.wikipedia.org/wiki/Euler%27s_formula#Relationship_to_trigonometry">exponential definitions</a>) of the two functions. Since the rules for differentiating polynomials and exponentials are the same for real and complex variables, the result follows easily from either set of definitions.</p>

<p>However, I still want you to see this point <i>visually</i>. But what does the graph of a derivative-antiderivative pair look like? Below you can see a few examples of real functions and their derivatives. Click on the pink buttons one by one to highlight some basic features of derivative-antiderivative graphs:</p>

<div id='realderiv' style='display: grid; grid-template-columns: 80% 20%; grid-template-rows: 50% 50%; grid-template-areas: "graph1 sidebar" "graph2 sidebar"; aspect-ratio: 1.25; margin-block-start: 1em; max-width: 45em; margin-left: auto; margin-right: auto'>
  <div style='grid-area: graph1; border: 1px solid #aaa; position: relative'>
    <svg id='real_func_graph' viewbox='0 0 100 50' style='width: 100%; height: 100%'></svg>
    <span style='position: absolute; bottom: .1em; left: .1em'>
      <span class="katex" style="font-size:1.1em"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathnormal" style="margin-right: 0.1076em;">f</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span></span></span></span>
    </span>
  </div>
  <div style='grid-area: graph2; border: 1px solid #aaa; position: relative'>
    <svg id='real_deriv_graph' viewbox='0 0 100 50' style='width: 100%; height: 100%'></svg>
    <span style='position: absolute; bottom: .1em; left: .1em'>
      <span class="katex" style="font-size:1.1em"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1.0019em; vertical-align: -0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.1076em;">f</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.7519em;"><span style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span></span></span></span>
    </span>
  </div>
  <div style='grid-area: sidebar; border: 1px solid #aaa; display: flex; flex-direction: column; row-gap: .3em; padding: .3em; overflow: hidden'>
    <button role='button' class='btn' id='choose_func1'>
      <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mop">sin</span><span class="mopen">(</span><span class="mop">sin</span><span class="mopen">(</span><span class="mop">cos</span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mord mathnormal">x</span><span class="mclose">))</span></span></span></span>
    </button>
    <button role='button' class='btn' id='choose_func2'>
      <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mop">tan</span><span class="mopen">(</span><span class="mop">sin</span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mord mathnormal">x</span><span class="mord">/</span><span class="mord mathnormal">x</span><span class="mclose">)</span></span></span></span>
    </button>
    <button role='button' class='btn' id='choose_func3'>
      <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mop">sin</span><span class="mopen">(</span><span class="mord">2</span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mop">sin</span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mord mathnormal">x</span><span class="mclose">)</span></span></span></span>
    </button>
    <hr style='margin: 0.3em 0'>
    <button role='button' class='btn fuschia-btn' style='white-space: wrap;' id='hilite_zeroes'>
      Zeroes
    </button>
    <button role='button' class='btn fuschia-btn' style='white-space: wrap;' id='hilite_positive'>
      Positive regions
    </button>
    <button role='button' class='btn fuschia-btn' style='white-space: wrap;' id='hilite_negative'>
      Negative regions
    </button>
    <button role='button' class='btn fuschia-btn' style='white-space: wrap;' id='hilite_maxima'>
      Maxima
    </button>
  </div>
</div>
<div style='margin-block-end: 1em; text-align: center; min-height: 1.5em' id='explain_deriv'></div>

<script type='module'>
  const svg1 = $id('real_func_graph');
  const svg2 = $id('real_deriv_graph');

  const xScale = 8, yScale = 1.1;

  function func1(x) {
    return Math.sin(Math.sin(Math.cos(x)));
  }
  function deriv1(x) {
    return Math.cos(Math.sin(Math.cos(x))) * Math.cos(Math.cos(x)) * -Math.sin(x);
  }
  const deriv1_zeroes = [-Math.PI, 0, Math.PI];
  const deriv1_maxima = [-Math.PI/2, Math.PI/2];
  const deriv1_pos = [[-xScale/2, -Math.PI], [0, Math.PI]];
  const deriv1_neg = [[-Math.PI, 0], [Math.PI, xScale/2]];
  function func2(x) {
    if (x == 0) return (Math.PI/2) * 0.6;
    return Math.tan(Math.sin(x) / x) * 0.6;
  }
  function deriv2(x) {
    if (x == 0) return 0;
    return ((Math.cos(x) / x) - (Math.sin(x) / x**2)) * (1 / Math.cos(Math.sin(x) / x)**2) * 0.6;
  }
  const deriv2_zeroes = [0];
  const deriv2_maxima = [-1.1, 1.1]; // approx
  const deriv2_pos = [[0, xScale/2]];
  const deriv2_neg = [[-xScale/2, 0]];
  function func3(x) {
    return Math.sin(2 * Math.sin(x)) * 0.5;
  }
  function deriv3(x) {
    return 2 * Math.cos(x) * Math.cos(2 * Math.sin(x)) * 0.5;
  }
  const deriv3_zeroes = [-Math.PI+0.903, -Math.PI/2, -0.903, 0.903, Math.PI/2, Math.PI-0.903];
  const deriv3_maxima = [-Math.PI, 0, Math.PI];
  const deriv3_pos = [[-xScale/2, -Math.PI+0.903], [-Math.PI/2, -0.903], [0.903, Math.PI/2], [Math.PI-0.903, xScale/2]];
  const deriv3_neg = [[-Math.PI+0.903, -Math.PI/2], [-0.903, 0.903], [Math.PI/2, Math.PI-0.903]];

  function funcXToSvgX(x) {
    return (x * 100 / xScale) + 50;
  }
  function svgXToFuncX(svgX) {
    return (svgX - 50) * xScale / 100;
  }
  function funcYToSvgY(y) {
    return (y + yScale) / yScale * 25;
  }
  function svgYToFuncY(svgY) {
    return (svgY * yScale / 25) - yScale;
  }
  function svgY(func, svgX) {
    return Math.round(funcYToSvgY(func(svgXToFuncX(svgX))) * 10) / 10;
  }

  function drawGraph(svg, func, color) {
    svg.innerHTML = '';
    prependSvgNode(svg, 'line', undefined, {
      y1: '25', y2: '25', x1: '0', x2: '100', stroke: '#444', "stroke-width": '0.2'
    });
    prependSvgNode(svg, 'line', undefined, {
      y1: '0', y2: '50', x1: '50', x2: '50', stroke: '#444', "stroke-width": '0.2'
    });
    let path = `M 0 ${svgY(func, 0)}`;
    const xValues = [], yValues = [];
    for (let svgX = 1; svgX <= 100; svgX++) {
      xValues.push(svgX);
      yValues.push(svgY(func, svgX));
    }
    for (let i = 1; i < yValues.length; i += 2)
      path += ` Q ${xValues[i-1]} ${yValues[i-1]} ${xValues[i]} ${yValues[i]}`;
    appendSvgNode(svg, 'path', undefined, {
      d: path, fill: 'none', stroke: color, "stroke-width": '0.33'
    });
  }

  drawGraph(svg1, func1, '#c22');
  drawGraph(svg2, deriv1, '#22c');
  let func = func1;
  let deriv = deriv1;
  let zeroes = deriv1_zeroes;
  let maxima = deriv1_maxima;
  let pos    = deriv1_pos;
  let neg    = deriv1_neg;

  function clearHighlights() {
    for (const elem of Array.from(svg2.$class('highlight')))
      elem.remove();
    for (const elem of Array.from(svg1.$class('highlight')))
      elem.remove();
    $id('explain_deriv').innerText = '';
  }

  function highlightZeroes() {
    clearHighlights();
    for (const zero of zeroes) {
      const svgX = funcXToSvgX(zero);
      appendSvgNode(svg2, 'line', 'highlight', {
        x1: svgX,
        x2: svgX,
        y1: '0',
        y2: '50',
        stroke: '#28c',
        "stroke-width": '0.3'
      });
      appendSvgNode(svg1, 'line', 'highlight', {
        x1: svgX,
        x2: svgX,
        y1: '0',
        y2: '50',
        stroke: '#28c',
        "stroke-width": '0.3'
      });
      /* Draw tangent lines */
      appendSvgNode(svg1, 'line', 'highlight', {
        x1: svgX-10,
        x2: svgX+10,
        y1: svgY(func, svgX),
        y2: svgY(func, svgX),
        stroke: '#28c',
        "stroke-width": '0.3'
      });
      appendSvgNode(svg2, 'circle', 'highlight', {
        r: '1.3',
        stroke: 'none',
        fill: '#22c',
        cx: svgX,
        cy: '25'
      });
    }
    $id('explain_deriv').innerHTML = 'Wherever <span class="katex" style="font-size:1.1em"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1.0019em; vertical-align: -0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.1076em;">f</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.7519em;"><span style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span></span></span></span></span> is zero, the graph of <span class="katex" style="font-size:1.1em"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathnormal" style="margin-right: 0.1076em;">f</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span></span></span></span> is flat.';
  }

  function highlightPositive() {
    clearHighlights();
    for (const [from, to] of pos) {
      appendSvgNode(svg1, 'rect', 'highlight', {
        x: funcXToSvgX(from),
        y: '0',
        width: (to - from) / xScale * 100,
        height: '50',
        stroke: 'none',
        fill: '#ee2',
        "fill-opacity": '0.25'
      });
      appendSvgNode(svg2, 'rect', 'highlight', {
        x: funcXToSvgX(from),
        y: '0',
        width: (to - from) / xScale * 100,
        height: '50',
        stroke: 'none',
        fill: '#ee2',
        "fill-opacity": '0.25'
      });
    }
    $id('explain_deriv').innerHTML = 'When <span class="katex" style="font-size:1.1em"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1.0019em; vertical-align: -0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.1076em;">f</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.7519em;"><span style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span></span></span></span></span> is positive, <span class="katex" style="font-size:1.1em"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathnormal" style="margin-right: 0.1076em;">f</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span></span></span></span> slopes upwards.';
  }

  function highlightNegative() {
    clearHighlights();
    for (const [from, to] of neg) {
      appendSvgNode(svg1, 'rect', 'highlight', {
        x: funcXToSvgX(from),
        y: '0',
        width: (to - from) / xScale * 100,
        height: '50',
        stroke: 'none',
        fill: '#ee2',
        "fill-opacity": '0.25'
      });
      appendSvgNode(svg2, 'rect', 'highlight', {
        x: funcXToSvgX(from),
        y: '0',
        width: (to - from) / xScale * 100,
        height: '50',
        stroke: 'none',
        fill: '#ee2',
        "fill-opacity": '0.25'
      });
    }
    $id('explain_deriv').innerHTML = 'When <span class="katex" style="font-size:1.1em"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1.0019em; vertical-align: -0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.1076em;">f</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.7519em;"><span style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span></span></span></span></span> is negative, <span class="katex" style="font-size:1.1em"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathnormal" style="margin-right: 0.1076em;">f</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span></span></span></span> slopes downwards.';
  }

  function highlightMaxima() {
    clearHighlights();
    for (const max of maxima) {
      const svgX = funcXToSvgX(max);
      appendSvgNode(svg2, 'line', 'highlight', {
        x1: svgX,
        x2: svgX,
        y1: '0',
        y2: '50',
        stroke: '#28c',
        "stroke-width": '0.3'
      });
      appendSvgNode(svg1, 'line', 'highlight', {
        x1: svgX,
        x2: svgX,
        y1: '0',
        y2: '50',
        stroke: '#28c',
        "stroke-width": '0.3'
      });
      /* Draw tangent lines */
      const slope = deriv((svgX - 50) * xScale / 100);
      const xOffset = (1 / Math.sqrt(slope**2 + 1));
      const yOffset = (slope / Math.sqrt(slope**2 + 1));
      appendSvgNode(svg1, 'line', 'highlight', {
        x1: svgX-(xOffset / xScale * 100),
        x2: svgX+(xOffset / xScale * 100),
        y1: svgY(func, svgX)-(yOffset / yScale * 25),
        y2: svgY(func, svgX)+(yOffset / yScale * 25),
        stroke: '#28c',
        "stroke-width": '0.3'
      });
      appendSvgNode(svg2, 'circle', 'highlight', {
        r: '1.3',
        stroke: 'none',
        fill: '#22c',
        cx: svgX,
        cy: svgY(deriv, svgX)
      });
    }
    $id('explain_deriv').innerHTML = 'At the maxima of <span class="katex" style="font-size:1.1em"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1.0019em; vertical-align: -0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.1076em;">f</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.7519em;"><span style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span></span></span></span></span>, the slope of <span class="katex" style="font-size:1.1em"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathnormal" style="margin-right: 0.1076em;">f</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span></span></span></span> is steepest.';
  }

  $id('choose_func1').listen('click', () => {
    clearHighlights();
    drawGraph(svg1, func1, '#c22');
    drawGraph(svg2, deriv1, '#22c');
    func = func1;
    deriv = deriv1;
    zeroes = deriv1_zeroes;
    maxima = deriv1_maxima;
    pos = deriv1_pos;
    neg = deriv1_neg;
  });
  $id('choose_func2').listen('click', () => {
    clearHighlights();
    drawGraph(svg1, func2, '#c22');
    drawGraph(svg2, deriv2, '#22c');
    func = func2;
    deriv = deriv2;
    zeroes = deriv2_zeroes;
    maxima = deriv2_maxima;
    pos = deriv2_pos;
    neg = deriv2_neg;
  });
  $id('choose_func3').listen('click', () => {
    clearHighlights();
    drawGraph(svg1, func3, '#c22');
    drawGraph(svg2, deriv3, '#22c');
    func = func3;
    deriv = deriv3;
    zeroes = deriv3_zeroes;
    maxima = deriv3_maxima;
    pos = deriv3_pos;
    neg = deriv3_neg;
  });
  $id('hilite_zeroes').listen('click', highlightZeroes);
  $id('hilite_positive').listen('click', highlightPositive);
  $id('hilite_negative').listen('click', highlightNegative);
  $id('hilite_maxima').listen('click', highlightMaxima);
</script>

<p>The same visual features apply (roughly) to the magnitude of a complex derivative. A visualization will follow soon, but to appreciate it, you need to know a bit more about complex derivatives.</p>

<p>Real derivatives tell you the best linear approximation to a real function near a point. In symbols: <span class="katex" style="font-size:1.1em"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathnormal" style="margin-right: 0.1076em;">f</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord">Δ</span><span class="mord mathnormal">x</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">≈</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathnormal" style="margin-right: 0.1076em;">f</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span class="base"><span class="strut" style="height: 1.0019em; vertical-align: -0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.1076em;">f</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.7519em;"><span style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span><span class="mord">Δ</span><span class="mord mathnormal">x</span></span></span>. The same relationship applies to complex derivatives, but now <span class="katex" style="font-size:1.1em"><span class="base"><span class="strut" style="height: 1.0019em; vertical-align: -0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.1076em;">f</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.7519em;"><span style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right: 0.044em;">z</span><span class="mclose">)</span></span></span> and <span class="katex" style="font-size:1.1em"><span class="base"><span class="strut" style="height: 0.6833em;"></span><span class="mord">Δ</span><span class="mord mathnormal" style="margin-right: 0.044em;">z</span></span></span> are both complex. <span class="katex" style="font-size:1.1em"><span class="base"><span class="strut" style="height: 1.0019em; vertical-align: -0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.1076em;">f</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.7519em;"><span style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right: 0.044em;">z</span><span class="mclose">)</span></span></span> is a <i>complex</i> number which multiplies small deviations <span class="katex" style="font-size:1.1em"><span class="base"><span class="strut" style="height: 0.6833em;"></span><span class="mord">Δ</span><span class="mord mathnormal" style="margin-right: 0.044em;">z</span></span></span> from the input point <span class="katex" style="font-size:1.1em"><span class="base"><span class="strut" style="height: 0.4306em;"></span><span class="mord mathnormal" style="margin-right: 0.044em;">z</span></span></span>, giving a linear approximation to <span class="katex" style="font-size:1.1em"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathnormal" style="margin-right: 0.1076em;">f</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right: 0.044em;">z</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord">Δ</span><span class="mord mathnormal" style="margin-right: 0.044em;">z</span><span class="mclose">)</span></span></span>.</p>

<p>But remember, complex multiplication includes both scaling and rotation. So unlike a real derivative, which just <i>scales</i> small deviations from a given input point, a complex derivative can both scale <i>and rotate</i> small deviations from an input point to approximate the corresponding output point.</p>

<p>Here is a little demonstration to build your intuition for how complex derivatives work. The black point <span style="color:#333">⬤</span> <span class="katex" style="font-size:1.1em"><span class="base"><span class="strut" style="height: 0.4306em;"></span><span class="mord mathnormal" style="margin-right: 0.044em;">z</span></span></span>, below, represents an input to a complex function. Imagine that our view is zoomed in extremely close, so we are looking at just a tiny piece of the complex plane. The red point <span style="color:#c33">⬤</span> <span class="katex" style="font-size:1.1em"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathnormal" style="margin-right: 0.1076em;">f</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right: 0.044em;">z</span><span class="mclose">)</span></span></span></span> is the output of the same function. (For this demonstration, we don’t care what the function <span class="katex" style="font-size:1.1em"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.8889em; vertical-align: -0.1944em;"></span><span class="mord mathnormal" style="margin-right: 0.1076em;">f</span></span></span></span> actually is; we are just interested in how its value changes for small changes of the input parameter.) Use your mouse cursor (or finger) to move the vector <span style="color:#33c">⬤</span><span class="katex" style="font-size:1.1em"><span class="base"><span class="strut" style="height: 0.6833em;"></span><span class="mord">Δ</span><span class="mord mathnormal" style="margin-right: 0.044em;">z</span></span></span> around and watch where <span style="color:#822">⬤</span> <span class="katex" style="font-size:1.1em"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathnormal" style="margin-right: 0.1076em;">f</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right: 0.044em;">z</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord">Δ</span><span class="mord mathnormal" style="margin-right: 0.044em;">z</span><span class="mclose">)</span></span></span> goes.</p>

<p>First, let’s say that <span class="katex" style="font-size:1.1em"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1.0019em; vertical-align: -0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.1076em;">f</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.7519em;"><span style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right: 0.044em;">z</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 0.6444em;"></span><span class="mord">2</span></span></span></span> (pure real), at least at this particular point <span class="katex" style="font-size:1.1em"><span class="base"><span class="strut" style="height: 0.4306em;"></span><span class="mord mathnormal" style="margin-right: 0.044em;">z</span></span></span>:</p>

<div id='complexderiv' style='margin-block-start: 1em; margin-block-end: 1em'>
  <div style="display: flex; justify-content: center">
    <span>
      <span class="katex" style="font-size:1.1em"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1.0019em; vertical-align: -0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.1076em;">f</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.7519em;"><span style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right: 0.044em;">z</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 0.6444em;"></span><span class="mord">2</span></span></span></span>
    </span>
  </div>
  <div style="display: flex; justify-content: center">
    <svg id='demo_pure_real_deriv' style='width: 100%; max-width: 32em; border: 1px solid #aaa' viewbox='0 0 100 100'>
      <defs>
        <marker id='arrow2' viewbox='0 0 8 8' refX='6.5' refY='4' markerWidth='4' markerHeight='4' orient='0' style='fill: #c22'>
          <path d='M 0 0 L 8 4 L 0 8 z' />
        </marker>
        <marker id='arrow3' viewbox='0 0 8 8' refX='6.5' refY='4' markerWidth='4' markerHeight='4' orient='0' style='fill: #333'>
          <path d='M 0 0 L 8 4 L 0 8 z' />
        </marker>
      </defs>
    </svg>
  </div>
</div>

<p>Now imagine our input point <span class="katex" style="font-size:1.1em"><span class="base"><span class="strut" style="height: 0.4306em;"></span><span class="mord mathnormal" style="margin-right: 0.044em;">z</span></span></span> has moved to some other place on the complex plane. Let’s say that here, <span class="katex" style="font-size:1.1em"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1.0019em; vertical-align: -0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.1076em;">f</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.7519em;"><span style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right: 0.044em;">z</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 0.6595em;"></span><span class="mord mathnormal">i</span></span></span></span> (pure imaginary):</p>

<div>
  <div style="display: flex; justify-content: center">
    <span>
      <span class="katex" style="font-size:1.1em"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1.0019em; vertical-align: -0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.1076em;">f</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.7519em;"><span style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right: 0.044em;">z</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 0.6595em;"></span><span class="mord mathnormal">i</span></span></span></span>
    </span>
  </div>
  <div style="display: flex; justify-content: center">
    <svg id='demo_pure_imag_deriv' style='width: 100%; max-width: 32em; border: 1px solid #aaa' viewbox='0 0 100 100'>
      <defs>
        <marker id='arrow4' viewbox='0 0 8 8' refX='6.5' refY='4' markerWidth='4' markerHeight='4' orient='0' style='fill: #c22'>
          <path d='M 0 0 L 8 4 L 0 8 z' />
        </marker>
        <marker id='arrow5' viewbox='0 0 8 8' refX='6.5' refY='4' markerWidth='4' markerHeight='4' orient='0' style='fill: #333'>
          <path d='M 0 0 L 8 4 L 0 8 z' />
        </marker>
      </defs>
    </svg>
  </div>
</div>

<p>Finally, see what would happen if <span class="katex" style="font-size:1.1em"><span class="base"><span class="strut" style="height: 0.4306em;"></span><span class="mord mathnormal" style="margin-right: 0.044em;">z</span></span></span> moved to another location on the complex plane where <span class="katex" style="font-size:1.1em"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1.0019em; vertical-align: -0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.1076em;">f</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.7519em;"><span style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right: 0.044em;">z</span><span class="mclose">)</span></span></span></span> is neither pure real nor pure imaginary:</p>

<div>
  <div style="display: flex; justify-content: center">
    <span>
      <span class="katex" style="font-size:1.1em"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1.0019em; vertical-align: -0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.1076em;">f</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.7519em;"><span style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right: 0.044em;">z</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 0.7278em; vertical-align: -0.0833em;"></span><span class="mord">−</span><span class="mord">0.5</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span class="base"><span class="strut" style="height: 0.6595em;"></span><span class="mord">1.5</span><span class="mord mathnormal">i</span></span></span></span>
    </span>
  </div>
  <div style="display: flex; justify-content: center">
    <svg id='demo_composite_deriv' style='width: 100%; max-width: 32em; border: 1px solid #aaa' viewbox='0 0 100 100'>
      <defs>
        <marker id='arrow6' viewbox='0 0 8 8' refX='6.5' refY='4' markerWidth='4' markerHeight='4' orient='0' style='fill: #c22'>
          <path d='M 0 0 L 8 4 L 0 8 z' />
        </marker>
        <marker id='arrow7' viewbox='0 0 8 8' refX='6.5' refY='4' markerWidth='4' markerHeight='4' orient='0' style='fill: #333'>
          <path d='M 0 0 L 8 4 L 0 8 z' />
        </marker>
      </defs>
    </svg>
  </div>
</div>

<script>
  'use strict';

  {
    const svg1 = $id('demo_pure_real_deriv');
    const svg2 = $id('demo_pure_imag_deriv');
    const svg3 = $id('demo_composite_deriv');

    const scale = 4;
    const circleRadius = 3;

    function svgPosToComplex(pos) {
      return new Complex([(pos.svgX / 100 * scale) - (scale / 2), -(pos.svgY / 100 * scale) + (scale / 2)]);
    }

    function complexToSvgPos(z) {
      const re = z.re, im = z.im;
      return {
        svgX: (re / scale * 100) + 50,
        svgY: -(im / scale * 100) + 50
      };
    }

    function svgPosToAngle(pos1, pos2) {
      const offsetX = pos2.svgX - pos1.svgX, offsetY = pos2.svgY - pos1.svgY;
      return Math.atan2(offsetY, offsetX);
    }

    function moveSvgArrow(arrow, marker, pos1, pos2) {
      const angle = svgPosToAngle(pos1, pos2);
      const dist = Math.sqrt((pos1.svgX - pos2.svgX)**2 + (pos1.svgY - pos2.svgY)**2);
      arrow.setAttribute('x1', pos1.svgX);
      arrow.setAttribute('y1', pos1.svgY);
      arrow.setAttribute('x2', pos1.svgX + ((dist - circleRadius - 0.3) * Math.cos(angle)));
      arrow.setAttribute('y2', pos1.svgY + ((dist - circleRadius - 0.3) * Math.sin(angle)));
      marker.setAttribute('orient', Math.round(angle / Math.PI * 180));
    }

    function setupComplexDerivativeDemo(svg, deriv, mark1, mark2) {
      const redDot = appendSvgNode(svg, 'circle', undefined, {
        r: String(circleRadius),
        fill: '#c33'
      });
      const darkRedDot = appendSvgNode(svg, 'circle', undefined, {
        r: String(circleRadius),
        fill: '#822'
      });
      const vector1 = appendSvgNode(svg, 'line', undefined, {
        stroke: '#c33',
        'stroke-width': '0.8',
        'marker-end': `url(#${mark1})`
      });
      const marker1 = $id(mark1);
      const blackDot = appendSvgNode(svg, 'circle', undefined, {
        r: String(circleRadius),
        fill: '#333'
      });
      const blueDot = appendSvgNode(svg, 'circle', undefined, {
        r: String(circleRadius),
        fill: '#33c'
      });
      const vector2 = appendSvgNode(svg, 'line', undefined, {
        stroke: '#333',
        'stroke-width': '0.8',
        'marker-end': `url(#${mark2})`
      });
      const marker2 = $id(mark2);
      const handIcon = appendSvgNode(svg, 'path', undefined, {
        style: 'fill: none; stroke: #fff; stroke-width: 0.2',
        d: 'M -1 0.65 v -2.41 c 0.01 -0.19 0.14 -0.29 0.29 -0.29 c 0.15 0 0.34 0.2 0.34 0.34 v 1.41 v -1.89 c -0 -0.15 0.14 -0.27 0.27 -0.27 c 0.14 0 0.31 0.15 0.31 0.31 v 1.85 v -1.58 c -0 -0.11 0.22 -0.23 0.36 -0.21 c 0.14 0.02 0.26 0.14 0.26 0.31 v 1.59 v -1.09 c -0 -0.13 0.2 -0.21 0.34 -0.19 c 0.14 0.02 0.23 0.15 0.23 0.31 v 2.33 c 0 0.13 -0 0.34 -0.04 0.52 c -0.04 0.18 -0.12 0.26 -0.25 0.38 c -0.13 0.11 -0.33 0.22 -0.48 0.28 c -0.15 0.06 -0.23 0.08 -0.41 0.09 c -0.18 0 -0.45 -0.03 -0.64 -0.12 c -0.19 -0.09 -0.43 -0.33 -0.48 -0.39 c -0.08 -0.1 -1.19 -1.69 -1.19 -1.69 c -0.06 -0.1 -0.01 -0.37 0.13 -0.45 c 0.13 -0.07 0.36 0.01 0.44 0.13 z'
      });

      const blackPos = complexToSvgPos(new Complex(-1.2, -0.2));
      const redPos = complexToSvgPos(new Complex(0.5, 0.4));

      moveSvgCircle(blackDot, blackPos);
      moveSvgCircle(redDot, redPos);

      function updateDots(dotPos) {
        moveSvgCircle(blueDot, dotPos);
        handIcon.setAttribute('transform', `translate(${dotPos.svgX} ${dotPos.svgY})`);
        moveSvgArrow(vector2, marker2, blackPos, dotPos);
        const diff = svgPosToComplex(dotPos).sub(svgPosToComplex(blackPos));
        const z = svgPosToComplex(redPos).add(diff.mul(deriv));
        const darkRedPos = complexToSvgPos(z);
        moveSvgCircle(darkRedDot, darkRedPos);
        moveSvgArrow(vector1, marker1, redPos, darkRedPos);
      }

      updateDots(complexToSvgPos(new Complex(-1, -0.2)));
      makeSvgCircleDraggable(svg, [blueDot, handIcon], updateDots);
    }

    setupComplexDerivativeDemo(svg1, new Complex(2, 0), 'arrow2', 'arrow3');
    setupComplexDerivativeDemo(svg2, new Complex(0, 1), 'arrow4', 'arrow5');
    setupComplexDerivativeDemo(svg3, new Complex(-0.5, 1.5), 'arrow6', 'arrow7');
  }
</script>

<p>After playing with those demonstrations, can you summarize how the <i>magnitude</i> and <i>angle</i> of a complex derivative control how the value of a complex function changes?</p>

<div class='reveal hidden'>
  <p>Here is one possible answer:</p>
  <p>The <i>magnitude</i> of a complex derivative controls how fast the value of the function grows, shrinks, <i>and/or rotates</i> as the input parameter changes.</p>
  <p>The <i>angle</i> of a complex derivative controls which direction the input parameter must move on the complex plane to make the function’s value grow, shrink, or rotate.</p>
  <p>If the angle of the derivative is zero, then moving the input parameter in the same direction as the output “vector” will make the output grow, whereas moving the input in the opposite direction will make the output shrink. At the other extreme, if the angle of the derivative is 90° or -90° (pure imaginary), then the input parameter must move perpendicular to the direction of the output “vector” to make the output grow or shrink.</p>
</div>

<p>So then, let’s look at the complex sine and cosine again and see if we can identify visual features analogous to those highlighted in <a href='#realderiv'>the above real derivative graphs</a>. Move the input point <span style="color:#333">⬤</span> <span class="katex" style="font-size:1.1em"><span class="base"><span class="strut" style="height: 0.4306em;"></span><span class="mord mathnormal" style="margin-right: 0.044em;">z</span></span></span> around the below grid, and the corresponding point on the sine and cosine plots will be highlighted. Try points where the magnitude of the cosine is large, those where it’s small, and those where it’s zero. Also, try points where the magnitude of the sine is large, small, or zero:</p>

<div style='margin-block-start: 1em; margin-block-end: 1em; display: flex; flex-direction: row; flex-wrap: wrap'>
  <div style='flex: 1; min-width: 20em; aspect-ratio: 1; border: 1px solid #aaa'>
    <svg id='deriv_demo_input' viewbox='0 0 100 100'></svg>
  </div>
  <div style='flex: 1; min-width: 20em; aspect-ratio: 1; border: 1px solid #aaa; cursor: move'>
    <div style='height: 100%; display: grid; grid-template-columns: 50% 50%; grid-template-rows: 50% 50%'>
      <div id='deriv_sine_magnitude' style='position: relative'>
        <span style='position: absolute; color: #ddd; bottom: .1em; left: .1em; user-select: none;'>|sin(z)|</span>
      </div>
      <div id='deriv_sine_angle' style='position: relative'>
        <span style='position: absolute; color: #ddd; bottom: .1em; left: .1em; user-select: none;'>arg(sin(z))</span>
      </div>
      <div id='deriv_cos_magnitude' style='position: relative'>
        <span style='position: absolute; color: #ddd; bottom: .1em; left: .1em; user-select: none;'>|cos(z)|</span>
      </div>
      <div id='deriv_cos_angle' style='position: relative'>
        <span style='position: absolute; color: #ddd; bottom: .1em; left: .1em; user-select: none;'>arg(cos(z))</span>
      </div>
    </div>
  </div>
</div>

<script type='module'>
  import * as THREE from 'three';
  import { OrbitControls } from '/assets/js/OrbitControls.js';

  const svg = $id('deriv_demo_input');
  const scale = 6; // Total width/height of SVG in function domain units

  const blackDot = appendSvgNode(svg, 'circle', undefined, {
    r: '3',
    fill: '#333'
  });
  const handIcon = appendSvgNode(svg, 'path', undefined, {
    style: 'fill: none; stroke: #fff; stroke-width: 0.2',
    d: 'M -1 0.65 v -2.41 c 0.01 -0.19 0.14 -0.29 0.29 -0.29 c 0.15 0 0.34 0.2 0.34 0.34 v 1.41 v -1.89 c -0 -0.15 0.14 -0.27 0.27 -0.27 c 0.14 0 0.31 0.15 0.31 0.31 v 1.85 v -1.58 c -0 -0.11 0.22 -0.23 0.36 -0.21 c 0.14 0.02 0.26 0.14 0.26 0.31 v 1.59 v -1.09 c -0 -0.13 0.2 -0.21 0.34 -0.19 c 0.14 0.02 0.23 0.15 0.23 0.31 v 2.33 c 0 0.13 -0 0.34 -0.04 0.52 c -0.04 0.18 -0.12 0.26 -0.25 0.38 c -0.13 0.11 -0.33 0.22 -0.48 0.28 c -0.15 0.06 -0.23 0.08 -0.41 0.09 c -0.18 0 -0.45 -0.03 -0.64 -0.12 c -0.19 -0.09 -0.43 -0.33 -0.48 -0.39 c -0.08 -0.1 -1.19 -1.69 -1.19 -1.69 c -0.06 -0.1 -0.01 -0.37 0.13 -0.45 c 0.13 -0.07 0.36 0.01 0.44 0.13 z'
  });

  const unitDist = (1/scale)*100;
  prependSvgNode(svg, 'line', undefined, {
    x1: '50', x2: '50', y1: '0', y2: '100', stroke: '#111', "stroke-width": '0.3'
  });
  prependSvgNode(svg, 'line', undefined, {
    y1: '50', y2: '50', x1: '0', x2: '100', stroke: '#111', "stroke-width": '0.3'
  });
  prependSvgNode(svg, 'line', undefined, {
    x1: String(50 - unitDist), x2: String(50 - unitDist), y1: '0', y2: '100', stroke: '#444', "stroke-width": '0.3'
  });
  prependSvgNode(svg, 'text', 'axislabel', { x: String(50 - unitDist + 0.5), y: '49.5' }).textContent = '-1';
  prependSvgNode(svg, 'line', undefined, {
    x1: String(50 + unitDist), x2: String(50 + unitDist), y1: '0', y2: '100', stroke: '#444', "stroke-width": '0.3'
  });
  prependSvgNode(svg, 'text', 'axislabel', { x: String(50 + unitDist + 0.5), y: '49.5' }).textContent = '1';
  prependSvgNode(svg, 'line', undefined, {
    y1: String(50 - unitDist), y2: String(50 - unitDist), x1: '0', x2: '100', stroke: '#444', "stroke-width": '0.3'
  });
  prependSvgNode(svg, 'text', 'axislabel', { x: '50.5', y: String(50 - unitDist - 0.5) }).textContent = 'i';
  prependSvgNode(svg, 'line', undefined, {
    y1: String(50 + unitDist), y2: String(50 + unitDist), x1: '0', x2: '100', stroke: '#444', "stroke-width": '0.3'
  });
  prependSvgNode(svg, 'text', 'axislabel', { x: '50.5', y: String(50 + unitDist - 0.5) }).textContent = '-i';
  prependSvgNode(svg, 'line', undefined, {
    x1: String(50 - 2*unitDist), x2: String(50 - 2*unitDist), y1: '0', y2: '100', stroke: '#444', "stroke-width": '0.3'
  });
  prependSvgNode(svg, 'text', 'axislabel', { x: String(50 - 2*unitDist + 0.5), y: '49.5' }).textContent = '-2';
  prependSvgNode(svg, 'line', undefined, {
    x1: String(50 + 2*unitDist), x2: String(50 + 2*unitDist), y1: '0', y2: '100', stroke: '#444', "stroke-width": '0.3'
  });
  prependSvgNode(svg, 'text', 'axislabel', { x: String(50 + 2*unitDist + 0.5), y: '49.5' }).textContent = '2';
  prependSvgNode(svg, 'line', undefined, {
    y1: String(50 - 2*unitDist), y2: String(50 - 2*unitDist), x1: '0', x2: '100', stroke: '#444', "stroke-width": '0.3'
  });
  prependSvgNode(svg, 'text', 'axislabel', { x: '50.5', y: String(50 - 2*unitDist - 0.5) }).textContent = '2i';
  prependSvgNode(svg, 'line', undefined, {
    y1: String(50 + 2*unitDist), y2: String(50 + 2*unitDist), x1: '0', x2: '100', stroke: '#444', "stroke-width": '0.3'
  });
  prependSvgNode(svg, 'text', 'axislabel', { x: '50.5', y: String(50 + 2*unitDist - 0.5) }).textContent = '-2i';

  function svgPosToComplex(pos) {
    return new Complex([(pos.svgX / 100 * scale) - (scale / 2), -(pos.svgY / 100 * scale) + (scale / 2)]);
  }

  function complexToSvgPos(z) {
    const re = z.re, im = z.im;
    return {
      svgX: (re / scale * 100) + 50,
      svgY: -(im / scale * 100) + 50
    };
  }

  moveSvgCircle(blackDot, {svgX: 50, svgY: 50});
  handIcon.setAttribute('transform', `translate(50, 50)`);

  if (window.hasWebGL) {

  const view1 = $id('deriv_sine_magnitude');
  const view2 = $id('deriv_sine_angle');
  const view3 = $id('deriv_cos_magnitude');
  const view4 = $id('deriv_cos_angle');

  const resolution = 30;

  const [vertices1, colors1] = meshVerticesForFunction(resolution, (z) => z.sin().abs(), viridis);
  const [vertices2, colors2] = meshVerticesForFunction(resolution, (z) => z.sin().arg(), magma);
  const [vertices3, colors3] = meshVerticesForFunction(resolution, (z) => z.cos().abs(), cool);
  const [vertices4, colors4] = meshVerticesForFunction(resolution, (z) => z.cos().arg(), warm);
  const indices = vertexIndicesForMesh(resolution);

  function createLine(from, to) {
    const material = new THREE.LineBasicMaterial({ color: 0xffffff });
    const geometry = new THREE.BufferGeometry().setFromPoints([from, to]);
    return new THREE.Line(geometry, material);
  }

  function showGraph(viewport, vertices, colors, cam_pos, cam_rot, target) {
    let viewWidth = viewport.clientWidth, viewHeight = viewport.clientHeight;

    const scene = new THREE.Scene;
    scene.background = new THREE.Color('#121212');

    const camera = new THREE.PerspectiveCamera(45, viewWidth / viewHeight, 1, 1000);
    camera.position.set(cam_pos[0], cam_pos[1], cam_pos[2]);
    camera.rotation.set(cam_rot[0], cam_rot[1], cam_rot[2]);

    const ambientLight = new THREE.AmbientLight(0xcccccc, 1);
    scene.add(ambientLight);

    const dirLight = new THREE.DirectionalLight(0xffffff, 3);
    dirLight.position.set(16, 18, 12);
    scene.add(dirLight);

    const geometry = new THREE.BufferGeometry;
    geometry.setIndex(indices);
    geometry.setAttribute('position', new THREE.BufferAttribute(vertices, 3));
    geometry.setAttribute('color', new THREE.BufferAttribute(colors, 4));
    geometry.computeVertexNormals();

    const material = new THREE.MeshPhongMaterial({
      side: THREE.DoubleSide, vertexColors: true, transparent: true, depthWrite: false
    });

    const mesh = new THREE.Mesh(geometry, material);
    scene.add(mesh);

    scene.add(createLine(new THREE.Vector3(1.5*Math.PI, 0, 0), new THREE.Vector3(-1.5*Math.PI, 0, 0)));
    scene.add(createLine(new THREE.Vector3(0, 12.5, 0), new THREE.Vector3(0, -12.5, 0)));
    scene.add(createLine(new THREE.Vector3(0, 0, 1.5*Math.PI), new THREE.Vector3(0, 0, -1.5*Math.PI)));

    const highlight = new THREE.Mesh(new THREE.SphereGeometry(0.4, 10, 10), new THREE.MeshLambertMaterial({color: 0xff0000}));
    scene.add(highlight);

    const renderer = new THREE.WebGLRenderer({ antialias: true });
    renderer.setPixelRatio(window.devicePixelRatio);
    renderer.setSize(viewWidth, viewHeight);
    viewport.appendChild(renderer.domElement);

    let redrawNeeded = false;
    function redrawIfNeeded() {
      if (redrawNeeded)
        renderer.render(scene, camera);
      redrawNeeded = false;
    }
    function redraw() {
      redrawNeeded = true;
      setTimeout(redrawIfNeeded, 80);
    }

    const controls = new OrbitControls(camera, renderer.domElement);
    controls.target.set(target[0], target[1], target[2]);
    controls.update();
    controls.addEventListener('change', redraw);

    new ResizeObserver(function() {
      viewWidth = viewport.clientWidth;
      viewHeight = viewport.clientHeight;
      renderer.setSize(viewWidth, viewHeight);
      redraw();
    }).observe(viewport);

    return function(x, y, z) {
      highlight.position.set(x, y, z);
      redraw();
    }
  }

  const update1 = showGraph(view1, vertices1, colors1, [11.92, 8.36, -4.73], [-2.32, 0.92, 2.44], [-0.4, 1.65, 1.63]);
  const update2 = showGraph(view2, vertices2, colors2, [6.37, 12.22, -7.26], [-2.04, 0.39, 2.5], [0.2, -1.11, -0.43]);
  const update3 = showGraph(view3, vertices3, colors3, [11.72, 11.28, -5.57], [-2.21, 0.78, 2.38], [-0.4, 1.65, 1.63]);
  const update4 = showGraph(view4, vertices4, colors4, [4.79, 12.62, -9.06], [-2.13, 0.3, 2.7], [-0.29, -1.11, -0.31]);

  function updateDerivDemo(dotPos) {
    moveSvgCircle(blackDot, dotPos);
    handIcon.setAttribute('transform', `translate(${dotPos.svgX} ${dotPos.svgY})`);
    const z = svgPosToComplex(dotPos);
    update1(z.re, z.sin().abs() / 2, z.im);
    update2(z.re, z.sin().arg() / 2, z.im);
    update3(z.re, z.cos().abs() / 2, z.im);
    update4(z.re, z.cos().arg() / 2, z.im);
  }

  updateDerivDemo({svgX: 50, svgY: 50});
  makeSvgCircleDraggable(svg, [blackDot, handIcon], updateDerivDemo);

  }
</script>

<p>Can you see that <i>both</i> the magnitude and angle of the sine change fastest around points where the magnitude of the cosine is large? And likewise, the magnitude and angle of the cosine change fastest around points where the magnitude of the sine is large?</p>

<div class='inset'>
  <h3>Digression: Most Complex Functions Don’t Have a Derivative</h3>
  <p>If you have studied basic calculus, you may know several reasons why a real function might not have a derivative (at least at certain points):</p>
  <p>
    <ul>
      <li>The function might be undefined at some points.</li>
      <li>The function might be discontinous.</li>
      <li>Even if continuous, the function’s graph might have sharp corners.</li>
    </ul>
  </p>
  <p>A complex function can fail to have a derivative for the same reasons, but there is another big reason why many, many complex functions do not have a derivative. Think about this: As was shown by the <a href='#complexderiv'>above interactive demonstration of how a complex derivative works</a>, a complex derivative tells you how to scale and/or rotate small deviations from an input point to get the corresponding deviation from its output point. (In symbols: <span class="katex" style="font-size:1.1em"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathnormal" style="margin-right: 0.1076em;">f</span><span class="mopen">(</span><span class="mord mathnormal">z</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord">Δ</span><span class="mord mathnormal">z</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">≈</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathnormal" style="margin-right: 0.1076em;">f</span><span class="mopen">(</span><span class="mord mathnormal">z</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span class="base"><span class="strut" style="height: 1.0019em; vertical-align: -0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.1076em;">f</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.7519em;"><span style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">z</span><span class="mclose">)</span><span class="mord">Δ</span><span class="mord mathnormal">z</span></span></span>.) The demonstration showed that the rate of scaling and/or rotation caused by <span class="katex" style="font-size:1.1em"><span class="base"><span class="strut" style="height: 1.0019em; vertical-align: -0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.1076em;">f</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.7519em;"><span style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right: 0.044em;">z</span><span class="mclose">)</span></span></span> does not depend on the direction of <span class="katex" style="font-size:1.1em"><span class="base"><span class="strut" style="height: 0.6833em;"></span><span class="mord">Δ</span><span class="mord mathnormal" style="margin-right: 0.044em;">z</span></span></span>; that’s how complex multiplication works!</p>
  <p><span style='font-variant: small-caps'>Example:</span> if <span class="katex" style="font-size:1.1em"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1.0019em; vertical-align: -0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.1076em;">f</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.7519em;"><span style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right: 0.044em;">z</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 0.6595em;"></span><span class="mord mathnormal">i</span></span></span></span>, then <span class="katex" style="font-size:1.1em"><span class="base"><span class="strut" style="height: 0.6833em;"></span><span class="mord">Δ</span><span class="mord mathnormal" style="margin-right: 0.044em;">z</span></span></span> will always be rotated by 90 degrees.</p>
  <p>But now think about this: there are many, many functions (i.e. ways to map input points to output points) where <span class="katex" style="font-size:1.1em"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathnormal" style="margin-right: 0.1076em;">f</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right: 0.044em;">z</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord">Δ</span><span class="mord mathnormal" style="margin-right: 0.044em;">z</span><span class="mclose">)</span></span></span> depends <i>very much</i> on the direction of <span class="katex" style="font-size:1.1em"><span class="base"><span class="strut" style="height: 0.6833em;"></span><span class="mord">Δ</span><span class="mord mathnormal" style="margin-right: 0.044em;">z</span></span></span>. Here’s a simple example:</p>
  <div style="margin-block-start: 1em; margin-block-end: 1em">
    <div style="display: flex; justify-content: center">
      <span>
        <span style="color:#333">⬤</span> is <span class="katex" style="font-size:1.1em"><span class="base"><span class="strut" style="height: 0.4306em;"></span><span class="mord mathnormal" style="margin-right: 0.044em;">z</span></span></span>,
        <span style="color:#c33">⬤</span> is <span class="katex" style="font-size:1.1em"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathnormal" style="margin-right: 0.1076em;">f</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right: 0.044em;">z</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mop">Re</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right: 0.044em;">z</span><span class="mclose">)</span></span></span></span>.
      </span>
    </div>
    <div style="display: flex; justify-content: center; margin-bottom: .5em">
      <span>
        Drag the input point <span style="color:#333">⬤</span> <span class="katex" style="font-size:1.1em"><span class="base"><span class="strut" style="height: 0.4306em;"></span><span class="mord mathnormal" style="margin-right: 0.044em;">z</span></span></span> around and observe how the output <span style="color:#c33">⬤</span> <span class="katex" style="font-size:1.1em"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathnormal" style="margin-right: 0.1076em;">f</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right: 0.044em;">z</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mop">Re</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right: 0.044em;">z</span><span class="mclose">)</span></span></span></span> changes.
      </span>
    </div>
    <div style="display: flex; justify-content: center">
      <svg id='real_part_z' style='width: 100%; height: 100%; max-width: 32em; max-height: 32em; border: 1px solid #aaa' viewbox='0 0 100 100'></svg>
    </div>
  </div>
  <p>Try moving <span style="color:#333">⬤</span> <span class="katex" style="font-size:1.1em"><span class="base"><span class="strut" style="height: 0.4306em;"></span><span class="mord mathnormal" style="margin-right: 0.044em;">z</span></span></span> around, and it will quickly become obvious that the direction which <span style="color:#c33">⬤</span> <span class="katex" style="font-size:1.1em"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathnormal" style="margin-right: 0.1076em;">f</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right: 0.044em;">z</span><span class="mclose">)</span></span></span></span> moves is <i>not</i> simply a rotated and/or scaled version of <span class="katex" style="font-size:1.1em"><span class="base"><span class="strut" style="height: 0.6833em;"></span><span class="mord">Δ</span><span class="mord mathnormal" style="margin-right: 0.044em;">z</span></span></span>; while <span class="katex" style="font-size:1.1em"><span class="base"><span class="strut" style="height: 0.4306em;"></span><span class="mord mathnormal" style="margin-right: 0.044em;">z</span></span></span> can move in any direction at all, <span class="katex" style="font-size:1.1em"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathnormal" style="margin-right: 0.1076em;">f</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right: 0.044em;">z</span><span class="mclose">)</span></span></span></span> only moves to the left or right, along the real axis. Since neither the angle between <span class="katex" style="font-size:1.1em"><span class="base"><span class="strut" style="height: 0.6833em;"></span><span class="mord">Δ</span><span class="mord mathnormal" style="margin-right: 0.044em;">z</span></span></span> and <span class="katex" style="font-size:1.1em"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord">Δ</span><span class="mord mathnormal" style="margin-right: 0.1076em;">f</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right: 0.044em;">z</span><span class="mclose">)</span></span></span></span>, nor the ratio of their magnitudes, is constant for a given position of <span class="katex" style="font-size:1.1em"><span class="base"><span class="strut" style="height: 0.4306em;"></span><span class="mord mathnormal" style="margin-right: 0.044em;">z</span></span></span>, the relationship between <span class="katex" style="font-size:1.1em"><span class="base"><span class="strut" style="height: 0.6833em;"></span><span class="mord">Δ</span><span class="mord mathnormal" style="margin-right: 0.044em;">z</span></span></span> and <span class="katex" style="font-size:1.1em"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord">Δ</span><span class="mord mathnormal" style="margin-right: 0.1076em;">f</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right: 0.044em;">z</span><span class="mclose">)</span></span></span></span> <i>cannot</i> be expressed as a simple complex multiplication by some number <span class="katex" style="font-size:1.1em"><span class="base"><span class="strut" style="height: 1.0019em; vertical-align: -0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.1076em;">f</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.7519em;"><span style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right: 0.044em;">z</span><span class="mclose">)</span></span></span>... but that’s precisely what a “complex derivative” means! And there we have it: <span class="katex" style="font-size:1.1em"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathnormal" style="margin-right: 0.1076em;">f</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right: 0.044em;">z</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mop">Re</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right: 0.044em;">z</span><span class="mclose">)</span></span></span></span> does not have a derivative.</p>
  <p>If you ever hear about “analytic functions”, that simply means “functions which have a complex derivative”. Like <span class="katex" style="font-size:1.1em"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mop">sin</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right: 0.044em;">z</span><span class="mclose">)</span></span></span> and <span class="katex" style="font-size:1.1em"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mop">cos</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right: 0.044em;">z</span><span class="mclose">)</span></span></span>!</p>
</div>

<script>
  'use strict';

  {
    const svg = $id('real_part_z');
    const scale = 4; // Total width/height of SVG in function domain units
    const redDot = appendSvgNode(svg, 'circle', undefined, {
      r: '3',
      fill: '#c33'
    });
    const blackDot = appendSvgNode(svg, 'circle', undefined, {
      r: '3',
      fill: '#333'
    });
    const handIcon = appendSvgNode(svg, 'path', undefined, {
      style: 'fill: none; stroke: #fff; stroke-width: 0.2',
      d: 'M -1 0.65 v -2.41 c 0.01 -0.19 0.14 -0.29 0.29 -0.29 c 0.15 0 0.34 0.2 0.34 0.34 v 1.41 v -1.89 c -0 -0.15 0.14 -0.27 0.27 -0.27 c 0.14 0 0.31 0.15 0.31 0.31 v 1.85 v -1.58 c -0 -0.11 0.22 -0.23 0.36 -0.21 c 0.14 0.02 0.26 0.14 0.26 0.31 v 1.59 v -1.09 c -0 -0.13 0.2 -0.21 0.34 -0.19 c 0.14 0.02 0.23 0.15 0.23 0.31 v 2.33 c 0 0.13 -0 0.34 -0.04 0.52 c -0.04 0.18 -0.12 0.26 -0.25 0.38 c -0.13 0.11 -0.33 0.22 -0.48 0.28 c -0.15 0.06 -0.23 0.08 -0.41 0.09 c -0.18 0 -0.45 -0.03 -0.64 -0.12 c -0.19 -0.09 -0.43 -0.33 -0.48 -0.39 c -0.08 -0.1 -1.19 -1.69 -1.19 -1.69 c -0.06 -0.1 -0.01 -0.37 0.13 -0.45 c 0.13 -0.07 0.36 0.01 0.44 0.13 z'
    });

    prependSvgNode(svg, 'line', undefined, {
      x1: '50', x2: '50', y1: '0', y2: '100', stroke: '#111', "stroke-width": '0.3'
    });
    prependSvgNode(svg, 'line', undefined, {
      y1: '50', y2: '50', x1: '0', x2: '100', stroke: '#111', "stroke-width": '0.3'
    });
    prependSvgNode(svg, 'line', undefined, {
      x1: '25', x2: '25', y1: '45', y2: '55', stroke: '#111', "stroke-width": '0.3'
    });
    prependSvgNode(svg, 'line', undefined, {
      x1: '25', x2: '25', y1: '0', y2: '100', stroke: '#666', "stroke-width": '0.2'
    });
    prependSvgNode(svg, 'text', 'axislabel', { x: '25.3', y: '49.5' }).textContent = '-1';
    prependSvgNode(svg, 'line', undefined, {
      x1: '75', x2: '75', y1: '45', y2: '55', stroke: '#111', "stroke-width": '0.3'
    });
    prependSvgNode(svg, 'line', undefined, {
      x1: '75', x2: '75', y1: '0', y2: '100', stroke: '#666', "stroke-width": '0.2'
    });
    prependSvgNode(svg, 'text', 'axislabel', { x: '75.3', y: '49.5' }).textContent = '1';
    prependSvgNode(svg, 'line', undefined, {
      y1: '25', y2: '25', x1: '45', x2: '55', stroke: '#111', "stroke-width": '0.3'
    });
    prependSvgNode(svg, 'line', undefined, {
      y1: '25', y2: '25', x1: '0', x2: '100', stroke: '#666', "stroke-width": '0.2'
    });
    prependSvgNode(svg, 'text', 'axislabel', { x: '50.5', y: '24.3' }).textContent = 'i';
    prependSvgNode(svg, 'line', undefined, {
      y1: '75', y2: '75', x1: '45', x2: '55', stroke: '#111', "stroke-width": '0.3'
    });
    prependSvgNode(svg, 'line', undefined, {
      y1: '75', y2: '75', x1: '0', x2: '100', stroke: '#666', "stroke-width": '0.2'
    });
    prependSvgNode(svg, 'text', 'axislabel', { x: '50.5', y: '74.3' }).textContent = '-i';
    const halfPiDist = Math.PI/scale*50;
    prependSvgNode(svg, 'line', undefined, {
      x1: String(50 - halfPiDist), x2: String(50 - halfPiDist), y1: '45', y2: '55', stroke: '#111', "stroke-width": '0.3'
    });
    prependSvgNode(svg, 'line', undefined, {
      x1: String(50 - halfPiDist), x2: String(50 - halfPiDist), y1: '0', y2: '100', stroke: '#666', "stroke-width": '0.2'
    });
    prependSvgNode(svg, 'text', 'axislabel', { x: String(50 - halfPiDist + 0.3), y: '49.5' }).textContent = '-π/2';
    prependSvgNode(svg, 'line', undefined, {
      x1: String(50 + halfPiDist), x2: String(50 + halfPiDist), y1: '45', y2: '55', stroke: '#111', "stroke-width": '0.3'
    });
    prependSvgNode(svg, 'line', undefined, {
      x1: String(50 + halfPiDist), x2: String(50 + halfPiDist), y1: '0', y2: '100', stroke: '#666', "stroke-width": '0.2'
    });
    prependSvgNode(svg, 'text', 'axislabel', { x: String(50 + halfPiDist + 0.3), y: '49.5' }).textContent = 'π/2';
    prependSvgNode(svg, 'line', undefined, {
      y1: String(50 - halfPiDist), y2: String(50 - halfPiDist), x1: '45', x2: '55', stroke: '#111', "stroke-width": '0.3'
    });
    prependSvgNode(svg, 'line', undefined, {
      y1: String(50 - halfPiDist), y2: String(50 - halfPiDist), x1: '0', x2: '100', stroke: '#666', "stroke-width": '0.2'
    });
    prependSvgNode(svg, 'text', 'axislabel', { x: '50.5', y: String(50 - halfPiDist - 0.7) }).textContent = 'iπ/2';
    prependSvgNode(svg, 'line', undefined, {
      y1: String(50 + halfPiDist), y2: String(50 + halfPiDist), x1: '45', x2: '55', stroke: '#111', "stroke-width": '0.3'
    });
    prependSvgNode(svg, 'line', undefined, {
      y1: String(50 + halfPiDist), y2: String(50 + halfPiDist), x1: '0', x2: '100', stroke: '#666', "stroke-width": '0.2'
    });
    prependSvgNode(svg, 'text', 'axislabel', { x: '50.5', y: String(50 + halfPiDist - 0.7) }).textContent = '-iπ/2';

    function svgPosToComplex(pos) {
      return new Complex([(pos.svgX / 100 * scale) - (scale / 2), -(pos.svgY / 100 * scale) + (scale / 2)]);
    }

    function complexToSvgPos(z) {
      const re = z.re, im = z.im;
      return {
        svgX: (re / scale * 100) + 50,
        svgY: -(im / scale * 100) + 50
      };
    }

    function updateRealPartZ(dotPos) {
      moveSvgCircle(blackDot, dotPos);
      handIcon.setAttribute('transform', `translate(${dotPos.svgX} ${dotPos.svgY})`);
      const z = svgPosToComplex(dotPos);
      moveSvgCircle(redDot, complexToSvgPos(new Complex(z.re, 0)));
    }

    updateRealPartZ({svgX: 25, svgY: 40});

    makeSvgCircleDraggable(svg, [blackDot, handIcon], updateRealPartZ);
  }
</script>

<h2>Outro</h2>

<p>I wanted to show that other trigonometric identities for the sine and cosine still work in the complex case, but couldn’t come up with good visualizations. In particular, I found it very hard to “see” <span class="katex" style="font-size:1.1em"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mop">sin</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right: 0.044em;">z</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathnormal" style="margin-right: 0.0269em;">w</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mop">sin</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right: 0.044em;">z</span><span class="mclose">)</span><span class="mop">cos</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right: 0.0269em;">w</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mop">cos</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right: 0.044em;">z</span><span class="mclose">)</span><span class="mop">sin</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right: 0.0269em;">w</span><span class="mclose">)</span></span></span></span> in the graphs of the complex sine and cosine. Can you see it? If so, please share!</p>
<p>In any case, many trig identities follow directly from the <a href="https://en.wikipedia.org/wiki/Euler%27s_formula#Relationship_to_trigonometry">exponential definitions</a> of sine and cosine. Since exponentials have the same basic properties regardless of whether the parameter is real or complex, such trig identities naturally work either way.</p>
<p><span style='font-variant: small-caps'><b>One last little fact:</b></span> If you slice the graph of <span class="katex" style="font-size:1.1em"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mop">sin</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right: 0.044em;">z</span><span class="mclose">)</span></span></span> straight along the imaginary axis (going through the origin), you get the graph of <span class="katex" style="font-size:1.1em"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mop">sinh</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right: 0.044em;">x</span><span class="mclose">)</span></span></span>, the <a href="https://en.wikipedia.org/wiki/Hyperbolic_functions"><i>hyperbolic</i> sine</a>. It’s the same for <span class="katex" style="font-size:1.1em"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mop">cos</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right: 0.044em;">z</span><span class="mclose">)</span></span></span>; along the imaginary axis, it gives the graph of the <a href="https://en.wikipedia.org/wiki/Hyperbolic_functions">hyperbolic cosine</a>. If this intrigues you, have another look at the 3D graphs above and see if you can pick out the contours of the hyperbolic trig functions.</p>

<p id='footnote1' style='font-size: 0.8em; margin-top: 2.5em'>[1] Answers: “A lot”, “Yes”, “For the most part”, “Not really”, and “You can be the judge of that”. <a href='#fnref1'>⏎</a></p>

<script>
  'use strict';

  function revealText(event) {
    event.preventDefault();
    this.classList.remove('hidden');
    this.removeEventListener('click', revealText);
  }
  document.querySelectorAll('.reveal').forEach((el) => el.addEventListener('click', revealText));

  if (!window.hasWebGL) {
    // Show warning banner
    const banner = document.createElement('div');
    banner.classList.add('webglwarning');
    banner.innerHTML = '<small><b>NOTE:</b></small> This article contains interactive 3D function graphs, which can be rotated and zoomed. However, your web browser does not provide the needed features for them to work. Hence, the 3D function graphs will be shown as static images only. You may wish to view this article on a different device or using a newer web browser.';
    document.$tag1('article').$tag1('header').after(banner);

    function makeImg(src, width, height) {
      let img = document.createElement('img');
      img.src = src;
      img.width = width;
      img.height = height;
      img.style.margin = '0';
      return img;
    }

    $id('sine_periodic_re').replaceChildren(makeImg('/assets/images/sine_periodic_re.jpg', 440, 445));
    $id('sine_periodic_re').style.cursor = '';

    $id('sine_periodic_im').replaceChildren(makeImg('/assets/images/sine_periodic_im.jpg', 439, 445));
    $id('sine_periodic_im').style.cursor = '';

    $id('sine_magnitude').replaceChildren(makeImg('/assets/images/sine_magnitude.jpg', 543, 543));
    $id('sine_magnitude').style.cursor = '';

    $id('sine_cos_magnitude_overlay').replaceWith(makeImg('/assets/images/sine_cos_magnitude_overlay.jpg', 537, 543));

    $id('sine_cos_angle_overlay').replaceWith(makeImg('/assets/images/sine_cos_angle_overlay.jpg', 538, 543));

    $id('real_sine_odd').prepend(makeImg('/assets/images/real_sine_odd.jpg', 368, 310));
    $id('real_cosine_even').prepend(makeImg('/assets/images/real_cos_even.jpg', 372, 310));

    $id('complex_sine_odd').replaceChildren(makeImg('/assets/images/complex_sine_odd.jpg', 539, 543));
    $id('complex_sine_odd').style.cursor = '';

    $id('deriv_sine_magnitude').replaceChildren(makeImg('/assets/images/deriv_sine_magnitude.jpg', 240, 244));
    $id('deriv_sine_angle').replaceChildren(makeImg('/assets/images/deriv_sine_angle.jpg', 240, 244));
    $id('deriv_cos_magnitude').replaceChildren(makeImg('/assets/images/deriv_cos_magnitude.jpg', 240, 244));
    $id('deriv_cos_angle').replaceChildren(makeImg('/assets/images/deriv_cos_angle.jpg', 240, 244));
  }
</script>
